(()=>{"use strict";new Set;const t="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;class e{_listeners="WeakMap"in t?new WeakMap:void 0;_observer=void 0;options;constructor(t){this.options=t}observe(t,e){return this._listeners.set(t,e),this._getObserver().observe(t,this.options),()=>{this._listeners.delete(t),this._observer.unobserve(t)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver((t=>{for(const n of t)e.entries.set(n.target,n),this._listeners.get(n.target)?.(n)})))}}e.entries="WeakMap"in t?new WeakMap:void 0;let n,o=!1;function r(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function s(t){t.parentNode&&t.parentNode.removeChild(t)}function i(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function c(t){return document.createElement(t)}function a(t){return document.createTextNode(t)}function u(){return a(" ")}function d(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function h(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function f(t,e){e=""+e,t.data!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function p(t,e,n){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}function b(){}function m(t){return t()}function g(){return Object.create(null)}function v(t){t.forEach(m)}function y(t){return"function"==typeof t}function _(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function k(t){n=t}new Map;const w=[],x=[];let E=[];const C=[],L=Promise.resolve();let M=!1;function O(t){E.push(t)}const N=new Set;let S=0;function R(){if(0!==S)return;const t=n;do{try{for(;S<w.length;){const t=w[S];S++,k(t),A(t.$$)}}catch(t){throw w.length=0,S=0,t}for(k(null),w.length=0,S=0;x.length;)x.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];N.has(e)||(N.add(e),e())}E.length=0}while(w.length);for(;C.length;)C.pop()();M=!1,N.clear(),k(t)}function A(t){if(null!==t.fragment){t.update(),v(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const P=new Set;let j,T;function q(){j={r:0,c:[],p:j}}function z(){j.r||v(j.c),j=j.p}function B(t,e){t&&t.i&&(P.delete(t),t.i(e))}function D(t,e,n,o){if(t&&t.o){if(P.has(t))return;P.add(t),j.c.push((()=>{P.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function J(t){return void 0!==t?.length?t:Array.from(t)}function H(t){t&&t.c()}function W(t,e,n){const{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),O((()=>{const e=t.$$.on_mount.map(m).filter(y);t.$$.on_destroy?t.$$.on_destroy.push(...e):v(e),t.$$.on_mount=[]})),r.forEach(O)}function K(t,e){const n=t.$$;null!==n.fragment&&(function(t){const e=[],n=[];E.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),E=e}(n.after_update),v(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function U(t,e,r,l,i,c,a=null,u=[-1]){const d=n;k(t);const h=t.$$={fragment:null,ctx:[],props:c,update:b,not_equal:i,bound:g(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:g(),dirty:u,skip_bound:!1,root:e.target||d.$$.root};a&&a(h.root);let f=!1;if(h.ctx=r?r(t,e.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return h.ctx&&i(h.ctx[e],h.ctx[e]=r)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](r),f&&function(t,e){-1===t.$$.dirty[0]&&(w.push(t),M||(M=!0,L.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n})):[],h.update(),f=!0,v(h.before_update),h.fragment=!!l&&l(h.ctx),e.target){if(e.hydrate){o=!0;const t=($=e.target,Array.from($.childNodes));h.fragment&&h.fragment.l(t),t.forEach(s)}else h.fragment&&h.fragment.c();e.intro&&B(t.$$.fragment),W(t,e.target,e.anchor),o=!1,R()}var $;k(d)}function F(t,e,n,o){const r=n[t]?.type;if(e="Boolean"===r&&"boolean"!=typeof e?null!=e:e,!o||!n[t])return e;if("toAttribute"===o)switch(r){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(r){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(T=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(t,e,n){super(),this.$$ctor=t,this.$$s=e,n&&this.attachShadow({mode:"open"})}addEventListener(t,e,n){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const n=this.$$c.$on(t,e);this.$$l_u.set(e,n)}super.addEventListener(t,e,n)}removeEventListener(t,e,n){if(super.removeEventListener(t,e,n),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(t){return()=>{let e;return{c:function(){e=c("slot"),"default"!==t&&h(e,"name",t)},m:function(t,n){l(t,e,n)},d:function(t){t&&s(e)}}}}const e={},n=function(t){const e={};return t.childNodes.forEach((t=>{e[t.slot||"default"]=!0})),e}(this);for(const r of this.$$s)r in n&&(e[r]=[t(r)]);for(const i of this.attributes){const a=this.$$g_p(i.name);a in this.$$d||(this.$$d[a]=F(a,i.value,this.$$p_d,"toProp"))}for(const u in this.$$p_d)u in this.$$d||void 0===this[u]||(this.$$d[u]=this[u],delete this[u]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});const o=()=>{this.$$r=!0;for(const t in this.$$p_d)if(this.$$d[t]=this.$$c.$$.ctx[this.$$c.$$.props[t]],this.$$p_d[t].reflect){const e=F(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1};this.$$c.$$.after_update.push(o),o();for(const d in this.$$l)for(const f of this.$$l[d]){const $=this.$$c.$on(d,f);this.$$l_u.set(f,$)}this.$$l={}}}attributeChangedCallback(t,e,n){this.$$r||(t=this.$$g_p(t),this.$$d[t]=F(t,n,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)}))}$$g_p(t){return Object.keys(this.$$p_d).find((e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t))||t}});class G{$$=void 0;$$set=void 0;$destroy(){K(this,1),this.$destroy=b}$on(t,e){if(!y(e))return b;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function I(t){let e,n,o,i,u=t[0].name+"";return{c(){e=c("button"),n=a(u),h(e,"class","btn btn-light border-dark m-1")},m(s,c){l(s,e,c),r(e,n),o||(i=d(e,"click",t[2]),o=!0)},p(t,[e]){1&e&&u!==(u=t[0].name+"")&&f(n,u)},i:b,o:b,d(t){t&&s(e),o=!1,i()}}}function Q(t,e,n){let{table:o}=e,{handleRoll:r}=e;return t.$$set=t=>{"table"in t&&n(0,o=t.table),"handleRoll"in t&&n(1,r=t.handleRoll)},[o,r,()=>r(o)]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const X=class extends G{constructor(t){super(),U(this,t,Q,I,_,{table:0,handleRoll:1})}},Z=["0","1","2","3","4","5","6","7","8","9"],V=new class{roll(t){let e=this.tokenize(t);return this.execute(e)}tokenize(t){let e=[],n=0;for(;n<t.length;){let r={value:t[n]};if(o=t[n],Z.indexOf(o)>=0){let o=e.length>0?e[e.length-1]:{};if("digit"==o.type){o.value+=t[n++];continue}r.type="digit"}"d"==t[n]&&(r.type="die"),"+"==t[n]&&(r.type="plus"),"-"==t[n]&&(r.type="minus"),e.push(r),n++}var o;return e}execute(t){let e=Number(t[0].value),n=Number(t[2].value),o=5==t.length&&"plus"==t[3].type?Number(t[4].value):0,r=5==t.length&&"minus"==t[3].type?Number(t[4].value):0,l=0;for(;e>0;)l+=Math.floor(Math.random()*n+1),e--;return l+o-r}};let Y=({table:t,modifier:e,tables:n})=>{console.log(`Rolling ${t.roll} + ${e} on ${t.name}`);let o=V.roll(t.roll+e),r=Math.max(...t.entries.map((t=>t.max))),l=Math.min(...t.entries.map((t=>t.min)));o>r&&(o=r),o<l&&(o=l);let s=t.entries.find((t=>t.min<=o&&t.max>=o));if(!s)return void alert(`Error - rolled ${o} on table ${t.id}`);let i=s.name;s.amount&&(i=`${i} (${V.roll(s.amount)})`);let c=[{roll:o,table:t.name,description:i}];return s.tables?(s.tables.forEach((t=>{console.log(`finding table with id ${t}`);let o=n.find((e=>e.id==t));console.log(`found table: ${o.name}`),o?c=c.concat(Y({table:o,modifier:e,tables:n})):c.push({roll:0,table:null,description:`Could not find table with id ${t}`})})),c):c};const tt={rollOnTable:Y};function et(t,e,n){const o=t.slice();return o[14]=e[n],o}function nt(t,e,n){const o=t.slice();return o[17]=e[n],o}function ot(t,e,n){const o=t.slice();return o[20]=e[n],o}function rt(t){let e,n,o,i=t[20]+"";return{c(){e=c("option"),n=a(i),e.__value=o=t[20],$(e,e.__value)},m(t,o){l(t,e,o),r(e,n)},p:b,d(t){t&&s(e)}}}function lt(t){let e,n;return e=new X({props:{table:t[17],handleRoll:t[7]}}),{c(){H(e.$$.fragment)},m(t,o){W(e,t,o),n=!0},p(t,n){const o={};16&n&&(o.table=t[17]),e.$set(o)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function st(t){let e,n,o,i,u,d,h,$=t[14].roll+"",p=t[14].table+"",b=t[14].description+"";return{c(){var t,r;e=c("p"),n=a("Rolled "),o=a($),i=a(" on "),u=a(p),d=a(": "),h=a(b),t=e,r="white-space",null=="pre-wrap"?t.style.removeProperty(r):t.style.setProperty(r,"pre-wrap","")},m(t,s){l(t,e,s),r(e,n),r(e,o),r(e,i),r(e,u),r(e,d),r(e,h)},p(t,e){8&e&&$!==($=t[14].roll+"")&&f(o,$),8&e&&p!==(p=t[14].table+"")&&f(u,p),8&e&&b!==(b=t[14].description+"")&&f(h,b)},d(t){t&&s(e)}}}function it(t){let e,n,o,b,m,g,y,_,k,w,x,E,C,L,M,N,S,R,A,P,j,T,H,W,K,U,F,G,I,Q,X,Z,V,Y=J(t[5]),tt=[];for(let e=0;e<Y.length;e+=1)tt[e]=rt(ot(t,Y,e));let it=J(t[4]),ct=[];for(let e=0;e<it.length;e+=1)ct[e]=lt(nt(t,it,e));const at=t=>D(ct[t],1,1,(()=>{ct[t]=null}));let ut=J(t[3]),dt=[];for(let e=0;e<ut.length;e+=1)dt[e]=st(et(t,ut,e));return{c(){e=c("div"),n=c("div"),o=c("div"),b=c("div"),m=c("div"),g=c("div"),y=c("div"),_=c("div"),k=c("button"),k.textContent="↓",w=u(),x=c("button"),E=a(t[2]),C=u(),L=c("button"),L.textContent="↑",M=u(),N=c("button"),N.textContent="reset",S=u(),R=c("input"),A=u(),P=c("select"),j=c("option");for(let t=0;t<tt.length;t+=1)tt[t].c();T=u(),H=c("div"),W=c("div"),K=c("div"),U=c("div");for(let t=0;t<ct.length;t+=1)ct[t].c();F=u(),G=c("div"),I=c("div"),Q=c("div");for(let t=0;t<dt.length;t+=1)dt[t].c();h(k,"class","btn btn-light border-dark"),h(x,"class","btn btn-dark border-dark"),h(L,"class","btn btn-light border-dark"),h(_,"class","btn-group m-1"),h(N,"class","btn btn-light border-dark m-1"),h(y,"class","d-flex"),h(R,"class","form-control"),h(R,"placeholder","filter"),j.__value="",$(j,j.__value),h(P,"class","form-control"),void 0===t[1]&&O((()=>t[13].call(P))),h(g,"class","card-body"),h(m,"class","card"),h(b,"class","col"),h(o,"class","row"),h(U,"class","card-body"),h(K,"class","card"),h(W,"class","col"),h(H,"class","row"),h(n,"class","col-md-6"),h(Q,"class","card-body"),h(I,"class","card"),h(G,"class","col"),h(e,"class","row")},m(s,i){l(s,e,i),r(e,n),r(n,o),r(o,b),r(b,m),r(m,g),r(g,y),r(y,_),r(_,k),r(_,w),r(_,x),r(x,E),r(_,C),r(_,L),r(y,M),r(y,N),r(g,S),r(g,R),$(R,t[0]),r(g,A),r(g,P),r(P,j);for(let t=0;t<tt.length;t+=1)tt[t]&&tt[t].m(P,null);p(P,t[1],!0),r(n,T),r(n,H),r(H,W),r(W,K),r(K,U);for(let t=0;t<ct.length;t+=1)ct[t]&&ct[t].m(U,null);r(e,F),r(e,G),r(G,I),r(I,Q);for(let t=0;t<dt.length;t+=1)dt[t]&&dt[t].m(Q,null);X=!0,Z||(V=[d(k,"click",t[9]),d(L,"click",t[10]),d(N,"click",t[11]),d(R,"input",t[12]),d(P,"change",t[13])],Z=!0)},p(t,[e]){if((!X||4&e)&&f(E,t[2]),1&e&&R.value!==t[0]&&$(R,t[0]),32&e){let n;for(Y=J(t[5]),n=0;n<Y.length;n+=1){const o=ot(t,Y,n);tt[n]?tt[n].p(o,e):(tt[n]=rt(o),tt[n].c(),tt[n].m(P,null))}for(;n<tt.length;n+=1)tt[n].d(1);tt.length=Y.length}if(34&e&&p(P,t[1]),144&e){let n;for(it=J(t[4]),n=0;n<it.length;n+=1){const o=nt(t,it,n);ct[n]?(ct[n].p(o,e),B(ct[n],1)):(ct[n]=lt(o),ct[n].c(),B(ct[n],1),ct[n].m(U,null))}for(q(),n=it.length;n<ct.length;n+=1)at(n);z()}if(8&e){let n;for(ut=J(t[3]),n=0;n<ut.length;n+=1){const o=et(t,ut,n);dt[n]?dt[n].p(o,e):(dt[n]=st(o),dt[n].c(),dt[n].m(Q,null))}for(;n<dt.length;n+=1)dt[n].d(1);dt.length=ut.length}},i(t){if(!X){for(let t=0;t<it.length;t+=1)B(ct[t]);X=!0}},o(t){ct=ct.filter(Boolean);for(let t=0;t<ct.length;t+=1)D(ct[t]);X=!1},d(t){t&&s(e),i(tt,t),i(ct,t),i(dt,t),Z=!1,v(V)}}}function ct(t,e,n){let o,{tables:r=[]}=e,l="",s="+0",i="",c=[],a=[...new Set(r.filter((t=>t.category)).map((t=>t.category)))];function u(t){t+=Number(s),n(2,s=t<0?`${t}`:`+${t}`)}return a.sort(((t,e)=>t.localeCompare(e))),t.$$set=t=>{"tables"in t&&n(8,r=t.tables)},t.$$.update=()=>{259&t.$$.dirty&&n(4,o=r.filter((t=>t.category)).filter((t=>!i||t.category==i)).filter((t=>t.name.toLowerCase().includes(l.toLowerCase()))))},[l,i,s,c,o,a,u,function(t){n(3,c=tt.rollOnTable({table:t,modifier:s,tables:r}))},r,()=>u(-1),()=>u(1),()=>n(2,s="+0"),function(){l=this.value,n(0,l)},function(){i=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),n(1,i),n(5,a)}]}const at=class extends G{constructor(t){super(),U(this,t,ct,it,_,{tables:8})}};class ut{constructor(t={url:""}){this.url=t.url}async get(t=""){return new Promise((e=>{let n=new XMLHttpRequest;n.open("get",`${this.url}/${t}`),n.onload=()=>{n.status>299?e():e(n.response)},n.send()}))}}class dt{constructor(){this.tables=[],this.client=new ut}async loadData(){let t=await this.client.get("seed.json");this.tables=JSON.parse(t),console.log(this.tables)}}const ht=new URLSearchParams(window.location.search).get("theme")??(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");function ft(t){window.location.search=`theme=${t}`}function $t(t){let e;return{c(){e=c("link"),h(e,"rel","stylesheet"),h(e,"href","https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"),h(e,"integrity","sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"),h(e,"crossorigin","anonymous")},m(t,n){l(t,e,n)},d(t){t&&s(e)}}}function pt(t){let e;return{c(){e=c("link"),h(e,"rel","stylesheet"),h(e,"href","https://cdn.jsdelivr.net/gh/vinorodrigues/bootstrap-dark@0.6.1/dist/bootstrap-dark.min.css")},m(t,n){l(t,e,n)},d(t){t&&s(e)}}}function bt(t){let e,n,o;return{c(){e=c("a"),e.textContent="Dark mode",h(e,"href","#")},m(r,s){l(r,e,s),n||(o=d(e,"click",t[2]),n=!0)},d(t){t&&s(e),n=!1,o()}}}function mt(t){let e,n,o;return{c(){e=c("a"),e.textContent="Light mode",h(e,"href","#")},m(r,s){l(r,e,s),n||(o=d(e,"click",t[1]),n=!0)},d(t){t&&s(e),n=!1,o()}}}function gt(t){return{c:b,m:b,p:b,i:b,o:b,d:b}}function vt(t){let e,n;return e=new at({props:{tables:t[0].tables}}),{c(){H(e.$$.fragment)},m(t,o){W(e,t,o),n=!0},p:b,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function yt(t){let e;return{c(){e=a("Loading table data...")},m(t,n){l(t,e,n)},p:b,i:b,o:b,d(t){t&&s(e)}}}function _t(t){let e,o,i,d,f,$,p,b,m,g,v,y,_,w=("dark"==ht?pt:$t)(t),x=("dark"==ht?mt:bt)(t),E={ctx:t,current:null,token:null,hasCatch:!1,pending:yt,then:vt,catch:gt,blocks:[,,,]};return function(t,e){const o=e.token={};function r(t,n,r,l){if(e.token!==o)return;e.resolved=l;let s=e.ctx;void 0!==r&&(s=s.slice(),s[r]=l);const i=t&&(e.current=t)(s);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,o)=>{o!==n&&t&&(q(),D(t,1,1,(()=>{e.blocks[o]===t&&(e.blocks[o]=null)})),z())})):e.block.d(1),i.c(),B(i,1),i.m(e.mount(),e.anchor),c=!0),e.block=i,e.blocks&&(e.blocks[n]=i),c&&R()}if(!(l=t)||"object"!=typeof l&&"function"!=typeof l||"function"!=typeof l.then){if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}else{const o=function(){if(!n)throw new Error("Function called outside component initialization");return n}();if(t.then((t=>{k(o),r(e.then,1,e.value,t),k(null)}),(t=>{if(k(o),r(e.catch,2,e.error,t),k(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}var l}(y=t[0].loadData(),E),{c(){e=c("link"),w.c(),o=a(""),i=u(),d=c("main"),f=c("div"),$=c("div"),$.innerHTML='<div class="col"><h1>Table Roller</h1></div>',p=u(),b=c("div"),x.c(),m=u(),g=c("hr"),v=u(),E.block.c(),h(e,"rel","stylesheet"),h(e,"href","global.css"),h($,"class","row"),h(b,"class","position-topright m-3"),h(f,"class","p-2"),h(d,"id","app")},m(t,n){r(document.head,e),w.m(document.head,null),r(document.head,o),l(t,i,n),l(t,d,n),r(d,f),r(f,$),r(f,p),r(f,b),x.m(b,null),r(f,m),r(f,g),r(f,v),E.block.m(f,E.anchor=null),E.mount=()=>f,E.anchor=null,_=!0},p(e,[n]){!function(t,e,n){const o=e.slice(),{resolved:r}=t;t.current===t.then&&(o[t.value]=r),t.current===t.catch&&(o[t.error]=r),t.block.p(o,n)}(E,t=e,n)},i(t){_||(B(E.block),_=!0)},o(t){for(let t=0;t<3;t+=1)D(E.blocks[t]);_=!1},d(t){t&&(s(i),s(d)),s(e),w.d(t),s(o),x.d(),E.block.d(),E.token=null,E=null}}}function kt(t){return[new dt,()=>ft("light"),()=>ft("dark")]}new class extends G{constructor(t){super(),U(this,t,kt,_t,_,{})}}({target:document.body,props:{}})})();