(()=>{"use strict";function t(){}const e=t=>t;function n(t){return t()}function l(){return Object.create(null)}function s(t){t.forEach(n)}function o(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}const i="undefined"!=typeof window;let r=i?()=>window.performance.now():()=>Date.now(),c=i?t=>requestAnimationFrame(t):t;const u=new Set;function d(t){u.forEach((e=>{e.c(t)||(u.delete(e),e.f())})),0!==u.size&&c(d)}const f="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;class h{_listeners="WeakMap"in f?new WeakMap:void 0;_observer=void 0;options;constructor(t){this.options=t}observe(t,e){return this._listeners.set(t,e),this._getObserver().observe(t,this.options),()=>{this._listeners.delete(t),this._observer.unobserve(t)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver((t=>{for(const e of t)h.entries.set(e.target,e),this._listeners.get(e.target)?.(e)})))}}h.entries="WeakMap"in f?new WeakMap:void 0;let b=!1;function p(t,e){t.appendChild(e)}function $(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function m(t){const e=w("style");return e.textContent="/* empty */",function(t,e){p(t.head||t,e),e.sheet}($(t),e),e.sheet}function g(t,e,n){t.insertBefore(e,n||null)}function v(t){t.parentNode&&t.parentNode.removeChild(t)}function y(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function w(t){return document.createElement(t)}function k(t){return document.createTextNode(t)}function x(){return k(" ")}function _(){return k("")}function C(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function T(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function M(t,e){e=""+e,t.data!==e&&(t.data=e)}function E(t,e){t.value=null==e?"":e}function L(t,e,n,l){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,l?"important":"")}function S(t,e,n){for(let n=0;n<t.options.length;n+=1){const l=t.options[n];if(l.__value===e)return void(l.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}function N(t){const e=t.querySelector(":checked");return e&&e.__value}const O=new Map;let A,R=0;function j(t){A=t}const q=[],D=[];let H=[];const P=[],z=Promise.resolve();let J=!1;function B(t){H.push(t)}function I(t){P.push(t)}const U=new Set;let F,K=0;function W(){if(0!==K)return;const t=A;do{try{for(;K<q.length;){const t=q[K];K++,j(t),G(t.$$)}}catch(t){throw q.length=0,K=0,t}for(j(null),q.length=0,K=0;D.length;)D.pop()();for(let t=0;t<H.length;t+=1){const e=H[t];U.has(e)||(U.add(e),e())}H.length=0}while(q.length);for(;P.length;)P.pop()();J=!1,U.clear(),j(t)}function G(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(B)}}function Z(t,e,n){t.dispatchEvent(function(t,e,{bubbles:n=!1,cancelable:l=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:l})}(`${e?"intro":"outro"}${n}`))}const Q=new Set;let X;function V(){X={r:0,c:[],p:X}}function Y(){X.r||s(X.c),X=X.p}function tt(t,e){t&&t.i&&(Q.delete(t),t.i(e))}function et(t,e,n,l){if(t&&t.o){if(Q.has(t))return;Q.add(t),X.c.push((()=>{Q.delete(t),l&&(n&&t.d(1),l())})),t.o(e)}else l&&l()}const nt={duration:0};function lt(n,l,a){const i={direction:"out"};let f,h=l(n,a,i),b=!0;const p=X;let g;function y(){const{delay:l=0,duration:o=300,easing:a=e,tick:i=t,css:v}=h||nt;v&&(f=function(t,e,n,l,s,o,a,i=0){const r=16.666/l;let c="{\n";for(let t=0;t<=1;t+=r){const l=e+(n-e)*o(t);c+=100*t+`%{${a(l,1-l)}}\n`}const u=c+`100% {${a(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${i}`,f=$(t),{stylesheet:h,rules:b}=O.get(f)||function(t,e){const n={stylesheet:m(e),rules:{}};return O.set(t,n),n}(f,t);b[d]||(b[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const p=t.style.animation||"";return t.style.animation=`${p?`${p}, `:""}${d} ${l}ms linear ${s}ms 1 both`,R+=1,d}(n,1,0,o,l,a,v));const y=r()+l,w=y+o;B((()=>Z(n,!1,"start"))),"inert"in n&&(g=n.inert,n.inert=!0),function(t){let e;0===u.size&&c(d),new Promise((n=>{u.add(e={c:t,f:n})}))}((t=>{if(b){if(t>=w)return i(0,1),Z(n,!1,"end"),--p.r||s(p.c),!1;if(t>=y){const e=a((t-y)/o);i(1-e,e)}}return b}))}return p.r+=1,o(h)?(F||(F=Promise.resolve(),F.then((()=>{F=null}))),F).then((()=>{h=h(i),y()})):y(),{end(t){t&&"inert"in n&&(n.inert=g),t&&h.tick&&h.tick(1,0),b&&(f&&function(t,e){const n=(t.style.animation||"").split(", "),l=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-l.length;s&&(t.style.animation=l.join(", "),R-=s,R||c((()=>{R||(O.forEach((t=>{const{ownerNode:e}=t.stylesheet;e&&v(e)})),O.clear())})))}(n,f),b=!1)}}}function st(t){return void 0!==t?.length?t:Array.from(t)}function ot(t,e){et(t,1,1,(()=>{e.delete(t.key)}))}function at(t,e,n,l,o,a,i,r,c,u,d,f){let h=t.length,b=a.length,p=h;const $={};for(;p--;)$[t[p].key]=p;const m=[],g=new Map,v=new Map,y=[];for(p=b;p--;){const t=f(o,a,p),s=n(t);let r=i.get(s);r?l&&y.push((()=>r.p(t,e))):(r=u(s,t),r.c()),g.set(s,m[p]=r),s in $&&v.set(s,Math.abs(p-$[s]))}const w=new Set,k=new Set;function x(t){tt(t,1),t.m(r,d),i.set(t.key,t),d=t.first,b--}for(;h&&b;){const e=m[b-1],n=t[h-1],l=e.key,s=n.key;e===n?(d=e.first,h--,b--):g.has(s)?!i.has(l)||w.has(l)?x(e):k.has(s)?h--:v.get(l)>v.get(s)?(k.add(l),x(e)):(w.add(s),h--):(c(n,i),h--)}for(;h--;){const e=t[h];g.has(e.key)||c(e,i)}for(;b;)x(m[b-1]);return s(y),m}let it;function rt(t,e,n){const l=t.$$.props[e];void 0!==l&&(t.$$.bound[l]=n,n(t.$$.ctx[l]))}function ct(t){t&&t.c()}function ut(t,e,l){const{fragment:a,after_update:i}=t.$$;a&&a.m(e,l),B((()=>{const e=t.$$.on_mount.map(n).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...e):s(e),t.$$.on_mount=[]})),i.forEach(B)}function dt(t,e){const n=t.$$;null!==n.fragment&&(function(t){const e=[],n=[];H.forEach((l=>-1===t.indexOf(l)?e.push(l):n.push(l))),n.forEach((t=>t())),H=e}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ft(e,n,o,a,i,r,c=null,u=[-1]){const d=A;j(e);const f=e.$$={fragment:null,ctx:[],props:r,update:t,not_equal:i,bound:l(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:l(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};c&&c(f.root);let h=!1;if(f.ctx=o?o(e,n.props||{},((t,n,...l)=>{const s=l.length?l[0]:n;return f.ctx&&i(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),h&&function(t,e){-1===t.$$.dirty[0]&&(q.push(t),J||(J=!0,z.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],f.update(),h=!0,s(f.before_update),f.fragment=!!a&&a(f.ctx),n.target){if(n.hydrate){b=!0;const t=(p=n.target,Array.from(p.childNodes));f.fragment&&f.fragment.l(t),t.forEach(v)}else f.fragment&&f.fragment.c();n.intro&&tt(e.$$.fragment),ut(e,n.target,n.anchor),b=!1,W()}var p;j(d)}function ht(t,e,n,l){const s=n[t]?.type;if(e="Boolean"===s&&"boolean"!=typeof e?null!=e:e,!l||!n[t])return e;if("toAttribute"===l)switch(s){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(s){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(it=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(t,e,n){super(),this.$$ctor=t,this.$$s=e,n&&this.attachShadow({mode:"open"})}addEventListener(t,e,n){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const n=this.$$c.$on(t,e);this.$$l_u.set(e,n)}super.addEventListener(t,e,n)}removeEventListener(t,e,n){if(super.removeEventListener(t,e,n),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(t){return()=>{let e;return{c:function(){e=w("slot"),"default"!==t&&T(e,"name",t)},m:function(t,n){g(t,e,n)},d:function(t){t&&v(e)}}}}const e={},n=function(t){const e={};return t.childNodes.forEach((t=>{e[t.slot||"default"]=!0})),e}(this);for(const s of this.$$s)s in n&&(e[s]=[t(s)]);for(const o of this.attributes){const a=this.$$g_p(o.name);a in this.$$d||(this.$$d[a]=ht(a,o.value,this.$$p_d,"toProp"))}for(const i in this.$$p_d)i in this.$$d||void 0===this[i]||(this.$$d[i]=this[i],delete this[i]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});const l=()=>{this.$$r=!0;for(const t in this.$$p_d)if(this.$$d[t]=this.$$c.$$.ctx[this.$$c.$$.props[t]],this.$$p_d[t].reflect){const e=ht(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1};this.$$c.$$.after_update.push(l),l();for(const r in this.$$l)for(const c of this.$$l[r]){const u=this.$$c.$on(r,c);this.$$l_u.set(c,u)}this.$$l={}}}attributeChangedCallback(t,e,n){this.$$r||(t=this.$$g_p(t),this.$$d[t]=ht(t,n,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)}))}$$g_p(t){return Object.keys(this.$$p_d).find((e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t))||t}});class bt{$$=void 0;$$set=void 0;$destroy(){dt(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const t=l.indexOf(n);-1!==t&&l.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function pt(e){let n,l,s,o,a=e[0].name+"";return{c(){n=w("button"),l=k(a),T(n,"class","btn btn-light border-dark m-1")},m(t,a){g(t,n,a),p(n,l),s||(o=C(n,"click",e[2]),s=!0)},p(t,[e]){1&e&&a!==(a=t[0].name+"")&&M(l,a)},i:t,o:t,d(t){t&&v(n),s=!1,o()}}}function $t(t,e,n){let{table:l}=e,{handleRoll:s}=e;return t.$$set=t=>{"table"in t&&n(0,l=t.table),"handleRoll"in t&&n(1,s=t.handleRoll)},[l,s,()=>s(l)]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const mt=class extends bt{constructor(t){super(),ft(this,t,$t,pt,a,{table:0,handleRoll:1})}},gt=["0","1","2","3","4","5","6","7","8","9"],vt=new class{roll(t){let e=this.tokenize(t);return this.execute(e)}tokenize(t){let e=[],n=0;for(;n<t.length;){let s={value:t[n]};if(l=t[n],gt.indexOf(l)>=0){let l=e.length>0?e[e.length-1]:{};if("digit"==l.type){l.value+=t[n++];continue}s.type="digit"}"d"==t[n]&&(s.type="die"),"+"==t[n]&&(s.type="plus"),"-"==t[n]&&(s.type="minus"),e.push(s),n++}var l;return e}execute(t){let e=Number(t[0].value),n=Number(t[2].value),l=5==t.length&&"plus"==t[3].type?Number(t[4].value):0,s=5==t.length&&"minus"==t[3].type?Number(t[4].value):0,o=0;for(;e>0;)o+=Math.floor(Math.random()*n+1),e--;return o+l-s}};let yt=({table:t,modifier:e,tables:n})=>{let l=e;t.applyModifiers||(l="+0"),console.log(`Rolling ${t.roll} + ${l} on ${t.name}`);let s=vt.roll(t.roll+l),o=Math.max(...t.entries.map((t=>t.max))),a=Math.min(...t.entries.map((t=>t.min)));s>o&&(s=o),s<a&&(s=a);let i=t.entries.find((t=>t.min<=s&&t.max>=s));if(!i)return void alert(`Error - rolled ${s} on table ${t.name} (id: ${t.id})`);let r=i.name;i.amount&&(r=`${r} (${vt.roll(i.amount)})`);let c=[{roll:s,table:t.name,description:r}];return i.tables?(i.tables.forEach((t=>{console.log(`finding table with id ${t}`);let l=n.find((e=>e.id==t));console.log(`found table: ${l.name}`),l?c=c.concat(yt({table:l,modifier:e,tables:n})):c.push({roll:0,table:null,description:`Could not find table with id ${t}`})})),c):c};const wt={rollOnTable:yt};function kt(t,{delay:n=0,duration:l=400,easing:s=e}={}){const o=+getComputedStyle(t).opacity;return{delay:n,duration:l,easing:s,css:t=>"opacity: "+t*o}}function xt(t,e,n){const l=t.slice();return l[20]=e[n],l}function _t(t,e,n){const l=t.slice();return l[23]=e[n],l}function Ct(t,e,n){const l=t.slice();return l[26]=e[n],l}function Tt(e){let n,l,s,o=e[26]+"";return{c(){n=w("option"),l=k(o),n.__value=s=e[26],E(n,n.__value)},m(t,e){g(t,n,e),p(n,l)},p:t,d(t){t&&v(n)}}}function Mt(t){let e,n;return e=new mt({props:{table:t[23],handleRoll:t[11]}}),{c(){ct(e.$$.fragment)},m(t,l){ut(e,t,l),n=!0},p(t,n){const l={};64&n&&(l.table=t[23]),e.$set(l)},i(t){n||(tt(e.$$.fragment,t),n=!0)},o(t){et(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function Et(e){let n,l,s,o,a;return{c(){n=w("button"),n.textContent="✓ copied!",T(n,"class","badge btn btn-success")},m(t,l){g(t,n,l),s=!0,o||(a=C(n,"click",e[19]),o=!0)},p:t,i(t){s||(l&&l.end(1),s=!0)},o(t){t&&(l=lt(n,kt,{})),s=!1},d(t){t&&v(n),t&&l&&l.end(),o=!1,a()}}}function Lt(t){let e,n,l,s,o,a,i,r=t[20].roll+"",c=t[20].table+"",u=t[20].description+"";return{c(){e=w("p"),n=k("Rolled "),l=k(r),s=k(" on "),o=k(c),a=k(": "),i=k(u),L(e,"white-space","pre-wrap")},m(t,r){g(t,e,r),p(e,n),p(e,l),p(e,s),p(e,o),p(e,a),p(e,i)},p(t,e){16&e&&r!==(r=t[20].roll+"")&&M(l,r),16&e&&c!==(c=t[20].table+"")&&M(o,c),16&e&&u!==(u=t[20].description+"")&&M(i,u)},d(t){t&&v(e)}}}function St(t){let e,n,l,o,a,i,r,c,u,d,f,h,b,$,m,_,L,N,O,A,R,j,q,D,H,P,z,J,I,U,F,K,W,G,Z,Q,X,nt,lt,ot,at,it,rt,ct,ut,dt=st(t[7]),ft=[];for(let e=0;e<dt.length;e+=1)ft[e]=Tt(Ct(t,dt,e));let ht=st(t[6]),bt=[];for(let e=0;e<ht.length;e+=1)bt[e]=Mt(_t(t,ht,e));const pt=t=>et(bt[t],1,1,(()=>{bt[t]=null}));let $t=t[5]&&Et(t),mt=st(t[4]),gt=[];for(let e=0;e<mt.length;e+=1)gt[e]=Lt(xt(t,mt,e));return{c(){e=w("div"),n=w("div"),l=w("div"),o=w("div"),a=w("div"),i=w("div"),r=w("div"),c=w("div"),u=w("button"),u.textContent="↓",d=x(),f=w("button"),h=k(t[3]),b=x(),$=w("button"),$.textContent="↑",m=x(),_=w("button"),_.textContent="reset",L=x(),N=w("input"),O=x(),A=w("select"),R=w("option");for(let t=0;t<ft.length;t+=1)ft[t].c();j=x(),q=w("label"),D=w("input"),H=x(),P=w("span"),P.textContent="Top Level Only",z=x(),J=w("div"),I=w("div"),U=w("div"),F=w("div");for(let t=0;t<bt.length;t+=1)bt[t].c();K=x(),W=w("div"),G=w("div"),Z=w("div"),Q=w("button"),Q.textContent="Copy Output",X=x(),nt=w("button"),nt.textContent="Copy Results",lt=x(),$t&&$t.c(),ot=x(),at=w("div"),it=w("div");for(let t=0;t<gt.length;t+=1)gt[t].c();T(u,"class","btn btn-light border-dark"),T(f,"class","btn btn-dark border-dark"),T($,"class","btn btn-light border-dark"),T(c,"class","btn-group m-1"),T(_,"class","btn btn-light border-dark m-1"),T(r,"class","d-flex"),T(N,"class","form-control"),T(N,"placeholder","filter"),R.__value="",E(R,R.__value),T(A,"class","form-control"),void 0===t[1]&&B((()=>t[17].call(A))),T(D,"type","checkbox"),T(q,"class","form group w-100"),T(i,"class","card-body"),T(a,"class","card"),T(o,"class","col"),T(l,"class","row"),T(F,"class","card-body"),T(U,"class","card"),T(I,"class","col"),T(J,"class","row"),T(n,"class","col-md-6"),T(Q,"class","btn btn-light"),T(nt,"class","btn btn-light"),T(Z,"class","card-body"),T(G,"class","card"),T(it,"class","card-body"),T(at,"class","card"),T(W,"class","col"),T(e,"class","row")},m(s,v){g(s,e,v),p(e,n),p(n,l),p(l,o),p(o,a),p(a,i),p(i,r),p(r,c),p(c,u),p(c,d),p(c,f),p(f,h),p(c,b),p(c,$),p(r,m),p(r,_),p(i,L),p(i,N),E(N,t[0]),p(i,O),p(i,A),p(A,R);for(let t=0;t<ft.length;t+=1)ft[t]&&ft[t].m(A,null);S(A,t[1],!0),p(i,j),p(i,q),p(q,D),D.checked=t[2],p(q,H),p(q,P),p(n,z),p(n,J),p(J,I),p(I,U),p(U,F);for(let t=0;t<bt.length;t+=1)bt[t]&&bt[t].m(F,null);p(e,K),p(e,W),p(W,G),p(G,Z),p(Z,Q),p(Z,X),p(Z,nt),p(Z,lt),$t&&$t.m(Z,null),p(W,ot),p(W,at),p(at,it);for(let t=0;t<gt.length;t+=1)gt[t]&&gt[t].m(it,null);rt=!0,ct||(ut=[C(u,"click",t[13]),C($,"click",t[14]),C(_,"click",t[15]),C(N,"input",t[16]),C(A,"change",t[17]),C(D,"change",t[18]),C(Q,"click",t[9]),C(nt,"click",t[10])],ct=!0)},p(t,[e]){if((!rt||8&e)&&M(h,t[3]),1&e&&N.value!==t[0]&&E(N,t[0]),128&e){let n;for(dt=st(t[7]),n=0;n<dt.length;n+=1){const l=Ct(t,dt,n);ft[n]?ft[n].p(l,e):(ft[n]=Tt(l),ft[n].c(),ft[n].m(A,null))}for(;n<ft.length;n+=1)ft[n].d(1);ft.length=dt.length}if(130&e&&S(A,t[1]),4&e&&(D.checked=t[2]),2112&e){let n;for(ht=st(t[6]),n=0;n<ht.length;n+=1){const l=_t(t,ht,n);bt[n]?(bt[n].p(l,e),tt(bt[n],1)):(bt[n]=Mt(l),bt[n].c(),tt(bt[n],1),bt[n].m(F,null))}for(V(),n=ht.length;n<bt.length;n+=1)pt(n);Y()}if(t[5]?$t?($t.p(t,e),32&e&&tt($t,1)):($t=Et(t),$t.c(),tt($t,1),$t.m(Z,null)):$t&&(V(),et($t,1,1,(()=>{$t=null})),Y()),16&e){let n;for(mt=st(t[4]),n=0;n<mt.length;n+=1){const l=xt(t,mt,n);gt[n]?gt[n].p(l,e):(gt[n]=Lt(l),gt[n].c(),gt[n].m(it,null))}for(;n<gt.length;n+=1)gt[n].d(1);gt.length=mt.length}},i(t){if(!rt){for(let t=0;t<ht.length;t+=1)tt(bt[t]);tt($t),rt=!0}},o(t){bt=bt.filter(Boolean);for(let t=0;t<bt.length;t+=1)et(bt[t]);et($t),rt=!1},d(t){t&&v(e),y(ft,t),y(bt,t),$t&&$t.d(),y(gt,t),ct=!1,s(ut)}}}function Nt(t,e,n){let l,{tables:s=[]}=e,o="",a="+0",i="",r=!0,c=[],u=!1,d=[...new Set(s.filter((t=>t.category)).map((t=>t.category)))].sort(((t,e)=>t.localeCompare(e)));function f(t){t+=Number(a),n(3,a=t<0?`${t}`:`+${t}`)}return t.$$set=t=>{"tables"in t&&n(12,s=t.tables)},t.$$.update=()=>{4103&t.$$.dirty&&n(6,l=s.filter((t=>!i||t.category==i)).filter((t=>!r||t.topLevel)).filter((t=>!o||t.name.toLowerCase().includes(o.toLowerCase()))))},[o,i,r,a,c,u,l,d,f,function(){n(5,u=!0),navigator.clipboard.writeText(c.map((t=>`Rolled ${t.roll} on ${t.table}: ${t.description}`)).reduce(((t,e)=>`${t}${e}\n`),""))},function(){n(5,u=!0),navigator.clipboard.writeText(c.map((t=>t.description)).reduce(((t,e)=>`${t}${e}\n`),""))},function(t){n(4,c=wt.rollOnTable({table:t,modifier:a,tables:s}))},s,()=>f(-1),()=>f(1),()=>n(3,a="+0"),function(){o=this.value,n(0,o)},function(){i=N(this),n(1,i),n(7,d)},function(){r=this.checked,n(2,r)},()=>n(5,u=!1)]}const Ot=class extends bt{constructor(t){super(),ft(this,t,Nt,St,a,{tables:12})}};function At(t,e,n){const l=t.slice();return l[6]=e[n],l}function Rt(t){let e,n;return{c(){e=w("option"),e.__value=n=t[6].name,E(e,e.__value)},m(t,n){g(t,e,n)},p(t,l){1&l&&n!==(n=t[6].name)&&(e.__value=n,E(e,e.__value))},d(t){t&&v(e)}}}function jt(e){let n,l,o,a,i,r,c,u,d=st(e[0]),f=[];for(let t=0;t<d.length;t+=1)f[t]=Rt(At(e,d,t));return{c(){n=w("label"),l=w("span"),l.textContent="Roll on table",o=x(),a=w("input"),i=x(),r=w("datalist");for(let t=0;t<f.length;t+=1)f[t].c();T(l,"class","collapse"),T(a,"class","form-control"),T(a,"list",e[2]),T(a,"placeholder","Roll on table..."),T(r,"id",e[2]),T(r,"value",e[1]),T(n,"class","form-group w-100 m-0")},m(t,s){g(t,n,s),p(n,l),p(n,o),p(n,a),E(a,e[1]),p(n,i),p(n,r);for(let t=0;t<f.length;t+=1)f[t]&&f[t].m(r,null);c||(u=[C(a,"input",e[5]),C(a,"change",e[3])],c=!0)},p(t,[e]){if(2&e&&a.value!==t[1]&&E(a,t[1]),1&e){let n;for(d=st(t[0]),n=0;n<d.length;n+=1){const l=At(t,d,n);f[n]?f[n].p(l,e):(f[n]=Rt(l),f[n].c(),f[n].m(r,null))}for(;n<f.length;n+=1)f[n].d(1);f.length=d.length}2&e&&T(r,"value",t[1])},i:t,o:t,d(t){t&&v(n),y(f,t),c=!1,s(u)}}}function qt(t,e,n){let{allTables:l}=e,{value:s}=e,o=crypto.randomUUID(),a=l.find((t=>t.id==s))?.name??"";return t.$$set=t=>{"allTables"in t&&n(0,l=t.allTables),"value"in t&&n(4,s=t.value)},[l,a,o,function(){let t=l.find((t=>t.name==a));t?n(4,s=t.id):alert(`Table ${a} does not exist`)},s,function(){a=this.value,n(1,a)}]}const Dt=class extends bt{constructor(t){super(),ft(this,t,qt,jt,a,{allTables:0,value:4})}};function Ht(e){let n,l,s,o,a,i,r;return{c(){n=w("label"),l=w("span"),s=k(e[1]),o=x(),a=w("input"),T(l,"class","collapse"),T(a,"class","form-control"),T(a,"placeholder",e[1]),T(n,"class","form-group w-100 m-0")},m(t,c){g(t,n,c),p(n,l),p(l,s),p(n,o),p(n,a),E(a,e[0]),i||(r=C(a,"input",e[2]),i=!0)},p(t,[e]){2&e&&M(s,t[1]),2&e&&T(a,"placeholder",t[1]),1&e&&a.value!==t[0]&&E(a,t[0])},i:t,o:t,d(t){t&&v(n),i=!1,r()}}}function Pt(t,e,n){let{label:l}=e,{value:s}=e;return t.$$set=t=>{"label"in t&&n(1,l=t.label),"value"in t&&n(0,s=t.value)},[s,l,function(){s=this.value,n(0,s)}]}const zt=class extends bt{constructor(t){super(),ft(this,t,Pt,Ht,a,{label:1,value:0})}};function Jt(t,e,n){const l=t.slice();return l[12]=e[n],l[13]=e,l[14]=n,l}function Bt(t){let e,n,l,o,a,i,r,c,u,d=st(t[0].tables),f=[];for(let e=0;e<d.length;e+=1)f[e]=It(Jt(t,d,e));const h=t=>et(f[t],1,1,(()=>{f[t]=null}));return{c(){e=w("div");for(let t=0;t<f.length;t+=1)f[t].c();n=x(),l=w("div"),o=w("button"),o.textContent="Add Table",a=x(),i=w("button"),i.textContent="Remove last table",T(o,"class","btn btn-light"),T(i,"class","btn btn-danger ml-1"),T(l,"class","d-flex mt-1"),T(e,"class","ml-2 p-2 border")},m(s,d){g(s,e,d);for(let t=0;t<f.length;t+=1)f[t]&&f[t].m(e,null);p(e,n),p(e,l),p(l,o),p(l,a),p(l,i),r=!0,c||(u=[C(o,"click",t[4]),C(i,"click",t[5])],c=!0)},p(t,l){if(5&l){let s;for(d=st(t[0].tables),s=0;s<d.length;s+=1){const o=Jt(t,d,s);f[s]?(f[s].p(o,l),tt(f[s],1)):(f[s]=It(o),f[s].c(),tt(f[s],1),f[s].m(e,n))}for(V(),s=d.length;s<f.length;s+=1)h(s);Y()}},i(t){if(!r){for(let t=0;t<d.length;t+=1)tt(f[t]);r=!0}},o(t){f=f.filter(Boolean);for(let t=0;t<f.length;t+=1)et(f[t]);r=!1},d(t){t&&v(e),y(f,t),c=!1,s(u)}}}function It(t){let e,n,l;function s(e){t[10](e,t[12],t[13],t[14])}let o={allTables:t[2]};return void 0!==t[12]&&(o.value=t[12]),e=new Dt({props:o}),D.push((()=>rt(e,"value",s))),{c(){ct(e.$$.fragment)},m(t,n){ut(e,t,n),l=!0},p(l,s){t=l;const o={};4&s&&(o.allTables=t[2]),!n&&1&s&&(n=!0,o.value=t[12],I((()=>n=!1))),e.$set(o)},i(t){l||(tt(e.$$.fragment,t),l=!0)},o(t){et(e.$$.fragment,t),l=!1},d(t){dt(e,t)}}}function Ut(t){let e,n,l,o,a,i,r,c,u,d,f,h,b,$,m,y,_,E,L,S,N=t[3]?"Hide tables":"Show tables";function O(e){t[6](e)}let A={label:"Minimum"};function R(e){t[7](e)}void 0!==t[0].min&&(A.value=t[0].min),n=new zt({props:A}),D.push((()=>rt(n,"value",O)));let j={label:"Maximum"};function q(e){t[8](e)}void 0!==t[0].max&&(j.value=t[0].max),a=new zt({props:j}),D.push((()=>rt(a,"value",R)));let H={label:"Name"};void 0!==t[0].name&&(H.value=t[0].name),c=new zt({props:H}),D.push((()=>rt(c,"value",q)));let P=t[3]&&Bt(t);return{c(){e=w("div"),ct(n.$$.fragment),o=x(),ct(a.$$.fragment),r=x(),ct(c.$$.fragment),d=x(),f=w("div"),h=w("button"),b=k(N),$=x(),P&&P.c(),m=x(),y=w("div"),_=w("button"),_.textContent="Delete entry",T(h,"class","text-left btn btn-light w-100"),T(_,"class","btn btn-danger"),T(_,"title","delete"),T(y,"class","d-flex"),T(e,"class","m-1 p-2 border")},m(l,s){g(l,e,s),ut(n,e,null),p(e,o),ut(a,e,null),p(e,r),ut(c,e,null),p(e,d),p(e,f),p(f,h),p(h,b),p(f,$),P&&P.m(f,null),p(e,m),p(e,y),p(y,_),E=!0,L||(S=[C(h,"click",t[9]),C(_,"click",t[11])],L=!0)},p(t,[e]){const s={};!l&&1&e&&(l=!0,s.value=t[0].min,I((()=>l=!1))),n.$set(s);const o={};!i&&1&e&&(i=!0,o.value=t[0].max,I((()=>i=!1))),a.$set(o);const r={};!u&&1&e&&(u=!0,r.value=t[0].name,I((()=>u=!1))),c.$set(r),(!E||8&e)&&N!==(N=t[3]?"Hide tables":"Show tables")&&M(b,N),t[3]?P?(P.p(t,e),8&e&&tt(P,1)):(P=Bt(t),P.c(),tt(P,1),P.m(f,null)):P&&(V(),et(P,1,1,(()=>{P=null})),Y())},i(t){E||(tt(n.$$.fragment,t),tt(a.$$.fragment,t),tt(c.$$.fragment,t),tt(P),E=!0)},o(t){et(n.$$.fragment,t),et(a.$$.fragment,t),et(c.$$.fragment,t),et(P),E=!1},d(t){t&&v(e),dt(n),dt(a),dt(c),P&&P.d(),L=!1,s(S)}}}function Ft(t,e,n){let{entry:l}=e,{deleteEntry:s}=e,{allTables:o}=e,a=!1;return t.$$set=t=>{"entry"in t&&n(0,l=t.entry),"deleteEntry"in t&&n(1,s=t.deleteEntry),"allTables"in t&&n(2,o=t.allTables)},[l,s,o,a,()=>{n(0,l.tables=[...l.tables,0],l)},()=>{n(0,l.tables=[...l.tables.slice(0,l.tables.length-1)],l)},function(e){t.$$.not_equal(l.min,e)&&(l.min=e,n(0,l))},function(e){t.$$.not_equal(l.max,e)&&(l.max=e,n(0,l))},function(e){t.$$.not_equal(l.name,e)&&(l.name=e,n(0,l))},()=>n(3,a=!a),function(t,e,s,o){s[o]=t,n(0,l)},()=>s(l)]}const Kt=class extends bt{constructor(t){super(),ft(this,t,Ft,Ut,a,{entry:0,deleteEntry:1,allTables:2})}},Wt="Changes saved successfully",Gt={saveList:"All entries will be replaced with current list. All entries will have a minimum and maximum equal to their position in the list. This action is irreversible."},Zt=new URLSearchParams(window.location.search).get("theme")??(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");function Qt(t){window.location.search=`theme=${t}`}const Xt={verticalButton:"btn btn-outline-light w-100 h-100 p-0"};function Vt(t,e,n){const l=t.slice();return l[30]=e[n],l}function Yt(t){let e,n,l,o,a,i,r,c,u,d,f,h,b,$,m,y,_,E,S,N,O,A,R,j,q,H,P,z,J,B,U,F,K,W,G,Z=t[4]?"Hide entries":"Show entries";function Q(e){t[16](e)}let X={label:"Display Name"};function nt(e){t[17](e)}void 0!==t[0].name&&(X.value=t[0].name),r=new zt({props:X}),D.push((()=>rt(r,"value",Q)));let lt={label:"Category"};function st(e){t[18](e)}void 0!==t[0].category&&(lt.value=t[0].category),d=new zt({props:lt}),D.push((()=>rt(d,"value",nt)));let ot={label:"Roll"};void 0!==t[0].roll&&(ot.value=t[0].roll),b=new zt({props:ot}),D.push((()=>rt(b,"value",st)));let at=t[4]&&te(t);return{c(){e=w("div"),n=w("div"),l=w("button"),l.innerHTML='<span class="collapse">Hide table definition</span>',a=x(),i=w("div"),ct(r.$$.fragment),u=x(),ct(d.$$.fragment),h=x(),ct(b.$$.fragment),m=x(),y=w("label"),_=w("input"),E=x(),S=w("span"),S.textContent="Top Level",N=x(),O=w("label"),A=w("input"),R=x(),j=w("span"),j.textContent="Apply Roll Modifiers",q=x(),H=w("hr"),P=x(),z=w("button"),J=k(Z),B=x(),at&&at.c(),U=x(),F=w("button"),F.textContent="Delete Table",T(l,"class",o=Xt.verticalButton),T(n,"class","pr-1"),L(n,"width","1em"),T(_,"type","checkbox"),T(y,"class","form-group w-100"),T(A,"type","checkbox"),T(O,"class","form-group w-100"),T(z,"class","btn btn-light w-100 text-left border"),T(F,"class","btn btn-danger border"),T(i,"class","flex-grow-1"),T(e,"class","d-flex")},m(s,o){g(s,e,o),p(e,n),p(n,l),p(e,a),p(e,i),ut(r,i,null),p(i,u),ut(d,i,null),p(i,h),ut(b,i,null),p(i,m),p(i,y),p(y,_),_.checked=t[0].topLevel,p(y,E),p(y,S),p(i,N),p(i,O),p(O,A),A.checked=t[0].applyModifiers,p(O,R),p(O,j),p(i,q),p(i,H),p(i,P),p(i,z),p(z,J),p(i,B),at&&at.m(i,null),p(i,U),p(i,F),K=!0,W||(G=[C(l,"click",t[15]),C(_,"change",t[19]),C(A,"change",t[20]),C(z,"click",t[21]),C(F,"click",t[28])],W=!0)},p(t,e){const n={};!c&&1&e[0]&&(c=!0,n.value=t[0].name,I((()=>c=!1))),r.$set(n);const l={};!f&&1&e[0]&&(f=!0,l.value=t[0].category,I((()=>f=!1))),d.$set(l);const s={};!$&&1&e[0]&&($=!0,s.value=t[0].roll,I((()=>$=!1))),b.$set(s),1&e[0]&&(_.checked=t[0].topLevel),1&e[0]&&(A.checked=t[0].applyModifiers),(!K||16&e[0])&&Z!==(Z=t[4]?"Hide entries":"Show entries")&&M(J,Z),t[4]?at?(at.p(t,e),16&e[0]&&tt(at,1)):(at=te(t),at.c(),tt(at,1),at.m(i,U)):at&&(V(),et(at,1,1,(()=>{at=null})),Y())},i(t){K||(tt(r.$$.fragment,t),tt(d.$$.fragment,t),tt(b.$$.fragment,t),tt(at),K=!0)},o(t){et(r.$$.fragment,t),et(d.$$.fragment,t),et(b.$$.fragment,t),et(at),K=!1},d(t){t&&v(e),dt(r),dt(d),dt(b),at&&at.d(),W=!1,s(G)}}}function te(t){let e,n,l,o,a,i,r,c,u,d,f,h,b,$,m,y,_,M,E,L,S,N,O,A;const R=[le,ne,ee],j=[];function q(t,e){return t[5]==t[8].designer?0:t[5]==t[8].list?1:t[5]==t[8].json?2:-1}return~(M=q(t))&&(E=j[M]=R[M](t)),{c(){e=w("button"),e.textContent="Add Entry",n=x(),l=w("button"),l.textContent="1 → N",o=x(),a=w("div"),i=w("button"),r=k("Designer"),u=x(),d=w("button"),f=k("List"),b=x(),$=w("button"),m=k("JSON"),_=x(),E&&E.c(),L=x(),S=w("hr"),T(e,"class","btn btn-light border"),T(l,"class","btn btn-light border"),T(i,"class",c="btn btn-light "+(t[5]==t[8].designer?"active":"")),T(d,"class",h="btn btn-light "+(t[5]==t[8].list?"active":"")),T($,"class",y="btn btn-light "+(t[5]==t[8].json?"active":"")),T(a,"class","btn-group")},m(s,c){g(s,e,c),g(s,n,c),g(s,l,c),g(s,o,c),g(s,a,c),p(a,i),p(i,r),p(a,u),p(a,d),p(d,f),p(a,b),p(a,$),p($,m),g(s,_,c),~M&&j[M].m(s,c),g(s,L,c),g(s,S,c),N=!0,O||(A=[C(e,"click",t[9]),C(l,"click",t[13]),C(i,"click",t[22]),C(d,"click",t[23]),C($,"click",t[24])],O=!0)},p(t,e){(!N||32&e[0]&&c!==(c="btn btn-light "+(t[5]==t[8].designer?"active":"")))&&T(i,"class",c),(!N||32&e[0]&&h!==(h="btn btn-light "+(t[5]==t[8].list?"active":"")))&&T(d,"class",h),(!N||32&e[0]&&y!==(y="btn btn-light "+(t[5]==t[8].json?"active":"")))&&T($,"class",y);let n=M;M=q(t),M===n?~M&&j[M].p(t,e):(E&&(V(),et(j[n],1,1,(()=>{j[n]=null})),Y()),~M?(E=j[M],E?E.p(t,e):(E=j[M]=R[M](t),E.c()),tt(E,1),E.m(L.parentNode,L)):E=null)},i(t){N||(tt(E),N=!0)},o(t){et(E),N=!1},d(t){t&&(v(e),v(n),v(l),v(o),v(a),v(_),v(L),v(S)),~M&&j[M].d(t),O=!1,s(A)}}}function ee(e){let n,l,o,a,i;return{c(){n=w("button"),n.textContent="Save",l=x(),o=w("textarea"),T(n,"class","btn btn-light ml-1"),T(o,"tabindex","0"),T(o,"contenteditable","true"),T(o,"class","form-control w-100"),L(o,"font-family","monospace"),L(o,"font-size","small"),L(o,"height","30em"),L(o,"resize","none")},m(t,s){g(t,n,s),g(t,l,s),g(t,o,s),E(o,e[6]),a||(i=[C(n,"click",e[11]),C(o,"input",e[27])],a=!0)},p(t,e){64&e[0]&&E(o,t[6])},i:t,o:t,d(t){t&&(v(n),v(l),v(o)),a=!1,s(i)}}}function ne(e){let n,l,o,a,i;return{c(){n=w("button"),n.textContent="Save",l=x(),o=w("textarea"),T(n,"class","btn btn-light ml-1"),T(o,"tabindex","0"),T(o,"contenteditable","true"),T(o,"class","form-control w-100"),L(o,"font-family","monospace"),L(o,"font-size","small"),L(o,"height","30em"),L(o,"resize","none")},m(t,s){g(t,n,s),g(t,l,s),g(t,o,s),E(o,e[7]),a||(i=[C(n,"click",e[12]),C(o,"input",e[26])],a=!0)},p(t,e){128&e[0]&&E(o,t[7])},i:t,o:t,d(t){t&&(v(n),v(l),v(o)),a=!1,s(i)}}}function le(t){let e,n,l,s,o,a,i,r,c,u,d,f,h=[],b=new Map,$=st(t[0].entries);const m=t=>t[30].id;for(let e=0;e<$.length;e+=1){let n=Vt(t,$,e),l=m(n);b.set(l,h[e]=se(l,n))}return{c(){e=w("div"),n=w("div"),l=w("button"),l.innerHTML='<span class="collapse">Hide table definition</span>',o=x(),a=w("table"),i=w("thead"),i.innerHTML="<tr><th>Item</th></tr>",r=x(),c=w("tbody");for(let t=0;t<h.length;t+=1)h[t].c();T(l,"class",s=Xt.verticalButton),T(n,"class","pr-1"),L(n,"width","1em"),T(i,"class","collapse"),T(a,"class","table table-striped flex-grow-1"),T(e,"class","d-flex")},m(s,b){g(s,e,b),p(e,n),p(n,l),p(e,o),p(e,a),p(a,i),p(a,r),p(a,c);for(let t=0;t<h.length;t+=1)h[t]&&h[t].m(c,null);u=!0,d||(f=C(l,"click",t[25]),d=!0)},p(t,e){1027&e[0]&&($=st(t[0].entries),V(),h=at(h,e,m,1,t,$,b,c,ot,se,null,Vt),Y())},i(t){if(!u){for(let t=0;t<$.length;t+=1)tt(h[t]);u=!0}},o(t){for(let t=0;t<h.length;t+=1)et(h[t]);u=!1},d(t){t&&v(e);for(let t=0;t<h.length;t+=1)h[t].d();d=!1,f()}}}function se(t,e){let n,l,s,o;return l=new Kt({props:{entry:e[30],deleteEntry:e[10],allTables:e[1]}}),{key:t,first:null,c(){n=w("tr"),ct(l.$$.fragment),s=x(),this.first=n},m(t,e){g(t,n,e),ut(l,n,null),p(n,s),o=!0},p(t,n){e=t;const s={};1&n[0]&&(s.entry=e[30]),2&n[0]&&(s.allTables=e[1]),l.$set(s)},i(t){o||(tt(l.$$.fragment,t),o=!0)},o(t){et(l.$$.fragment,t),o=!1},d(t){t&&v(n),dt(l)}}}function oe(t){let e,n,l,s,o,a,i,r=t[0].name+"",c=t[3]&&Yt(t);return{c(){e=w("div"),n=w("button"),l=k(r),s=x(),c&&c.c(),T(n,"class","text-left btn btn-light border w-100"),T(e,"class","w-100 mb-1")},m(r,u){g(r,e,u),p(e,n),p(n,l),p(e,s),c&&c.m(e,null),o=!0,a||(i=C(n,"click",t[14]),a=!0)},p(t,n){(!o||1&n[0])&&r!==(r=t[0].name+"")&&M(l,r),t[3]?c?(c.p(t,n),8&n[0]&&tt(c,1)):(c=Yt(t),c.c(),tt(c,1),c.m(e,null)):c&&(V(),et(c,1,1,(()=>{c=null})),Y())},i(t){o||(tt(c),o=!0)},o(t){et(c),o=!1},d(t){t&&v(e),c&&c.d(),a=!1,i()}}}function ae(t,e,n){let{table:l}=e,{allTables:s}=e,{deleteTable:o}=e;const a={designer:"designer",json:"json",list:"list"};let i=!1,r=!1,c=a.designer,u=JSON.stringify(l.entries,null,2),d=l.entries.map((t=>t.name)).reduce(((t,e)=>`${t}${e}\n`),""),f=()=>{n(5,c=a.designer),n(0,l),alert(Wt)};return t.$$set=t=>{"table"in t&&n(0,l=t.table),"allTables"in t&&n(1,s=t.allTables),"deleteTable"in t&&n(2,o=t.deleteTable)},[l,s,o,i,r,c,u,d,a,()=>{let t=0==l.entries.length?1:Math.max(...l.entries.map((t=>t.id)))+1,e=0==l.entries.length?1:Math.max(...l.entries.map((t=>t.max)))+1;n(0,l.entries=[{id:t,name:"",min:e,max:e,tables:[]},...l.entries],l),n(0,l)},t=>{let e=l.entries.indexOf(t);n(0,l.entries=[...l.entries.slice(0,e),...l.entries.slice(e+1,l.entries.length)],l),n(0,l)},()=>{try{let t=JSON.parse(u);t.forEach(((t,e)=>{t.min=t.min?t.min:e+1,t.max=t.max?t.max:e+1,t.name=t.name?t.name:"New entry",t.tables=t.tables?t.tables:[]})),n(0,l.entries=t,l),f()}catch(t){alert(t)}},()=>{confirm(Gt.saveList)&&(n(0,l.entries=d.split("\n").filter((t=>t)).map(((t,e)=>({min:e+1,max:e+1,name:t,tables:[]}))),l),f())},()=>{l.entries.sort(((t,e)=>t.min-e.min)),n(0,l),n(0,l)},()=>n(3,i=!i),()=>n(3,i=!1),function(e){t.$$.not_equal(l.name,e)&&(l.name=e,n(0,l))},function(e){t.$$.not_equal(l.category,e)&&(l.category=e,n(0,l))},function(e){t.$$.not_equal(l.roll,e)&&(l.roll=e,n(0,l))},function(){l.topLevel=this.checked,n(0,l)},function(){l.applyModifiers=this.checked,n(0,l)},()=>n(4,r=!r),()=>n(5,c=a.designer),()=>n(5,c=a.list),()=>n(5,c=a.json),()=>n(4,r=!1),function(){d=this.value,n(7,d)},function(){u=this.value,n(6,u)},()=>o(l)]}const ie=class extends bt{constructor(t){super(),ft(this,t,ae,oe,a,{table:0,allTables:1,deleteTable:2},null,[-1,-1])}};function re(t,e,n){const l=t.slice();return l[15]=e[n],l}function ce(t,e,n){const l=t.slice();return l[18]=e[n],l}function ue(t){let e,n,l,s=t[18]+"";return{c(){e=w("option"),n=k(s),e.__value=l=t[18],E(e,e.__value)},m(t,l){g(t,e,l),p(e,n)},p(t,o){128&o&&s!==(s=t[18]+"")&&M(n,s),128&o&&l!==(l=t[18])&&(e.__value=l,E(e,e.__value))},d(t){t&&v(e)}}}function de(t,e){let n,l,s;return l=new ie({props:{table:e[15],allTables:e[0],deleteTable:e[9]}}),{key:t,first:null,c(){n=_(),ct(l.$$.fragment),this.first=n},m(t,e){g(t,n,e),ut(l,t,e),s=!0},p(t,n){e=t;const s={};64&n&&(s.table=e[15]),1&n&&(s.allTables=e[0]),l.$set(s)},i(t){s||(tt(l.$$.fragment,t),s=!0)},o(t){et(l.$$.fragment,t),s=!1},d(t){t&&v(n),dt(l,t)}}}function fe(t){let e,n,l,a,i,r,c,u,d,f,h,b,$,m,k,_,M,L,N,O,A,R,j,q,H,P,z,J,U,F,K=[],W=new Map;function G(e){t[12](e)}let Z={label:"Filter"};void 0!==t[4]&&(Z.value=t[4]),$=new zt({props:Z}),D.push((()=>rt($,"value",G)));let Q=st(t[7]),X=[];for(let e=0;e<Q.length;e+=1)X[e]=ue(ce(t,Q,e));let nt=st(t[6]);const lt=t=>t[15].id;for(let e=0;e<nt.length;e+=1){let n=re(t,nt,e),l=lt(n);W.set(l,K[e]=de(l,n))}return{c(){e=w("div"),n=w("button"),n.textContent="A → Z",l=x(),a=w("button"),a.textContent="Z → A",i=x(),r=w("button"),r.textContent="Add Table",c=x(),u=w("button"),u.textContent="Reset",d=x(),f=w("button"),f.textContent="Delete All",h=x(),b=w("div"),ct($.$$.fragment),k=x(),_=w("label"),M=w("span"),M.textContent="Category filter",L=x(),N=w("select"),O=w("option");for(let t=0;t<X.length;t+=1)X[t].c();A=x(),R=w("label"),j=w("input"),q=x(),H=w("span"),H.textContent="Top Level Only",P=x(),z=w("div");for(let t=0;t<K.length;t+=1)K[t].c();T(n,"class","btn btn-light"),T(a,"class","btn btn-light"),T(r,"class","btn btn-light"),T(u,"class","btn btn-danger"),T(f,"class","btn btn-danger"),T(e,"class","m-2 p-2 border"),T(M,"class","collapse"),O.__value="",E(O,O.__value),T(N,"class","form-control"),void 0===t[3]&&B((()=>t[13].call(N))),T(_,"class","form-group w-100 m-0"),T(j,"type","checkbox"),T(R,"class","form-group w-100"),T(b,"class","m-2 p-2 border"),T(z,"class","p-2")},m(s,m){g(s,e,m),p(e,n),p(e,l),p(e,a),p(e,i),p(e,r),p(e,c),p(e,u),p(e,d),p(e,f),g(s,h,m),g(s,b,m),ut($,b,null),p(b,k),p(b,_),p(_,M),p(_,L),p(_,N),p(N,O);for(let t=0;t<X.length;t+=1)X[t]&&X[t].m(N,null);S(N,t[3],!0),p(b,A),p(b,R),p(R,j),j.checked=t[5],p(R,q),p(R,H),g(s,P,m),g(s,z,m);for(let t=0;t<K.length;t+=1)K[t]&&K[t].m(z,null);J=!0,U||(F=[C(n,"click",t[10]),C(a,"click",t[11]),C(r,"click",t[8]),C(u,"click",(function(){o(t[1])&&t[1].apply(this,arguments)})),C(f,"click",(function(){o(t[2])&&t[2].apply(this,arguments)})),C(N,"change",t[13]),C(j,"change",t[14])],U=!0)},p(e,[n]){t=e;const l={};if(!m&&16&n&&(m=!0,l.value=t[4],I((()=>m=!1))),$.$set(l),128&n){let e;for(Q=st(t[7]),e=0;e<Q.length;e+=1){const l=ce(t,Q,e);X[e]?X[e].p(l,n):(X[e]=ue(l),X[e].c(),X[e].m(N,null))}for(;e<X.length;e+=1)X[e].d(1);X.length=Q.length}136&n&&S(N,t[3]),32&n&&(j.checked=t[5]),577&n&&(nt=st(t[6]),V(),K=at(K,n,lt,1,t,nt,W,z,ot,de,null,re),Y())},i(t){if(!J){tt($.$$.fragment,t);for(let t=0;t<nt.length;t+=1)tt(K[t]);J=!0}},o(t){et($.$$.fragment,t);for(let t=0;t<K.length;t+=1)et(K[t]);J=!1},d(t){t&&(v(e),v(h),v(b),v(P),v(z)),dt($),y(X,t);for(let t=0;t<K.length;t+=1)K[t].d();U=!1,s(F)}}}function he(t,e,n){let l,s,{tables:o}=e,{reset:a}=e,{deleteAll:i}=e,r="",c="",u=!1;return t.$$set=t=>{"tables"in t&&n(0,o=t.tables),"reset"in t&&n(1,a=t.reset),"deleteAll"in t&&n(2,i=t.deleteAll)},t.$$.update=()=>{1&t.$$.dirty&&n(7,l=[...new Set(o.filter((t=>t.category)).map((t=>t.category)))].sort(((t,e)=>t.localeCompare(e)))),57&t.$$.dirty&&n(6,s=o.filter((t=>!u||t.topLevel)).filter((t=>!r||t.category==r)).filter((t=>!c||t.name.toLowerCase().includes(c.toLowerCase()))))},[o,a,i,r,c,u,s,l,()=>{let t=Math.max(...o.map((t=>t.id)))+1;n(0,o=[{id:t,name:"New Table",category:r,roll:"",topLevel:u,applyModifiers:!1,entries:[]},...o])},t=>{if(!confirm(`Delete ${t.name}? This action is irreversible.`))return;let e=o.indexOf(t);n(0,o=[...o.slice(0,e),...o.slice(e+1,o.length)])},()=>{o.sort(((t,e)=>t.name.localeCompare(e.name))),n(0,o)},()=>{o.sort(((t,e)=>e.name.localeCompare(t.name))),n(0,o)},function(t){c=t,n(4,c)},function(){r=N(this),n(3,r),n(7,l),n(0,o)},function(){u=this.checked,n(5,u)}]}const be=class extends bt{constructor(t){super(),ft(this,t,he,fe,a,{tables:0,reset:1,deleteAll:2})}};class pe{constructor(t={url:""}){this.url=t.url}async get(t=""){return new Promise((e=>{let n=new XMLHttpRequest;n.open("get",`${this.url}${t}`),n.onload=()=>{n.status>299?e():e(n.response)},n.send()}))}}const $e="knave2e-gm-tools-tables";class me{constructor(){this.tables=[],this.client=new pe,this.done=!1}async loadData(){if(this.tables.length>0)return;let t=localStorage.getItem($e);if(t)try{return this.tables=JSON.parse(t),void(this.done=!0)}catch{alert("Could not parse stored tables, loading default tables.")}await this.reset()}async reset(){let t=await this.client.get("seed.json");this.tables=JSON.parse(t),this.done=!0}save(){localStorage.setItem($e,JSON.stringify(this.tables)),alert("Saved current tables")}}function ge(t){let e;return{c(){e=w("link"),T(e,"rel","stylesheet"),T(e,"href","https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"),T(e,"integrity","sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"),T(e,"crossorigin","anonymous")},m(t,n){g(t,e,n)},d(t){t&&v(e)}}}function ve(t){let e;return{c(){e=w("link"),T(e,"rel","stylesheet"),T(e,"href","https://cdn.jsdelivr.net/gh/vinorodrigues/bootstrap-dark@0.6.1/dist/bootstrap-dark.min.css")},m(t,n){g(t,e,n)},d(t){t&&v(e)}}}function ye(t){let e,n,l;return{c(){e=w("a"),e.textContent="Dark mode",T(e,"class","nav-link"),T(e,"href","#")},m(s,o){g(s,e,o),n||(l=C(e,"click",t[12]),n=!0)},d(t){t&&v(e),n=!1,l()}}}function we(t){let e,n,l;return{c(){e=w("a"),e.textContent="Light mode",T(e,"class","nav-link"),T(e,"href","#")},m(s,o){g(s,e,o),n||(l=C(e,"click",t[11]),n=!0)},d(t){t&&v(e),n=!1,l()}}}function ke(t){let e,n,l;function s(e){t[14](e)}let o={reset:t[3],deleteAll:t[4]};return void 0!==t[1].tables&&(o.tables=t[1].tables),e=new be({props:o}),D.push((()=>rt(e,"tables",s))),{c(){ct(e.$$.fragment)},m(t,n){ut(e,t,n),l=!0},p(t,l){const s={};!n&&2&l&&(n=!0,s.tables=t[1].tables,I((()=>n=!1))),e.$set(s)},i(t){l||(tt(e.$$.fragment,t),l=!0)},o(t){et(e.$$.fragment,t),l=!1},d(t){dt(e,t)}}}function xe(t){let e,n,l,s,o,a,i,r;function c(e){t[13](e)}let u={};return void 0!==t[1].tables&&(u.tables=t[1].tables),a=new Ot({props:u}),D.push((()=>rt(a,"tables",c))),{c(){e=w("div"),n=w("div"),n.innerHTML='<div class="col"><h1>Table Roller</h1></div>',l=x(),s=w("hr"),o=x(),ct(a.$$.fragment),T(n,"class","row"),T(e,"class","p-2")},m(t,i){g(t,e,i),p(e,n),p(e,l),p(e,s),p(e,o),ut(a,e,null),r=!0},p(t,e){const n={};!i&&2&e&&(i=!0,n.tables=t[1].tables,I((()=>i=!1))),a.$set(n)},i(t){r||(tt(a.$$.fragment,t),r=!0)},o(t){et(a.$$.fragment,t),r=!1},d(t){t&&v(e),dt(a)}}}function _e(e){let n;return{c(){n=k("Loading table data...")},m(t,e){g(t,n,e)},p:t,i:t,o:t,d(t){t&&v(n)}}}function Ce(t){let e,n,l,o,a,i,r,c,u,d,f,h,b,$,m,y,k,M,E,L,S,N,O,A,R,j,q,D,H,P,z,J,B,I,U,F,K,W=("dark"==Zt?ve:ge)(t),G=("dark"==Zt?we:ye)(t);const Z=[_e,xe,ke],Q=[];function X(t,e){return t[1]&&t[1].done?"tables"==t[0]?1:"manager"==t[0]?2:-1:0}return~(B=X(t))&&(I=Q[B]=Z[B](t)),{c(){e=w("link"),W.c(),n=_(),l=x(),o=w("main"),a=w("nav"),i=w("a"),i.textContent="Knave 2e GM Tools",r=x(),c=w("button"),c.innerHTML='<span class="navbar-toggler-icon"></span>',u=x(),d=w("div"),f=w("ul"),h=w("li"),b=w("a"),b.textContent="Table Roller",m=x(),y=w("li"),k=w("a"),k.textContent="Table Manager",E=x(),L=w("li"),S=w("a"),S.textContent="Import Tables",N=x(),O=w("li"),A=w("a"),A.textContent="Export Tables",R=x(),j=w("li"),q=w("a"),q.textContent="Save Tables",D=x(),H=w("ul"),P=w("li"),G.c(),J=x(),I&&I.c(),T(e,"rel","stylesheet"),T(e,"href","global.css"),T(i,"class","navbar-brand"),T(i,"href","#"),T(c,"class","navbar-toggler"),T(c,"type","button"),T(c,"aria-controls","navbarSupportedContent"),T(c,"aria-expanded","false"),T(c,"aria-label","Toggle navigation"),T(b,"class","nav-link"),T(b,"href","#"),T(h,"class",$="nav-item "+("tables"==t[0]?"active":"")),T(k,"class","nav-link"),T(k,"href","#"),T(y,"class",M="nav-item "+("manager"==t[0]?"active":"")),T(S,"class","nav-link"),T(S,"href","#"),T(L,"class","nav-item"),T(A,"class","nav-link"),T(A,"href","#"),T(O,"class","nav-item"),T(q,"class","nav-link"),T(q,"href","#"),T(j,"class","nav-item"),T(f,"class","navbar-nav mr-auto"),T(P,"class","nav-item"),T(H,"class","navbar-nav ml-auto"),T(d,"class",z=(t[2]?"":"collapse")+" navbar-collapse"),T(a,"class","navbar navbar-expand-lg navbar-light bg-light"),T(o,"id","app")},m(s,$){p(document.head,e),W.m(document.head,null),p(document.head,n),g(s,l,$),g(s,o,$),p(o,a),p(a,i),p(a,r),p(a,c),p(a,u),p(a,d),p(d,f),p(f,h),p(h,b),p(f,m),p(f,y),p(y,k),p(f,E),p(f,L),p(L,S),p(f,N),p(f,O),p(O,A),p(f,R),p(f,j),p(j,q),p(d,D),p(d,H),p(H,P),G.m(P,null),p(o,J),~B&&Q[B].m(o,null),U=!0,F||(K=[C(c,"click",t[6]),C(b,"click",t[7]),C(k,"click",t[8]),C(S,"click",t[5]),C(A,"click",t[9]),C(q,"click",t[10])],F=!0)},p(t,[e]){(!U||1&e&&$!==($="nav-item "+("tables"==t[0]?"active":"")))&&T(h,"class",$),(!U||1&e&&M!==(M="nav-item "+("manager"==t[0]?"active":"")))&&T(y,"class",M),(!U||4&e&&z!==(z=(t[2]?"":"collapse")+" navbar-collapse"))&&T(d,"class",z);let n=B;B=X(t),B===n?~B&&Q[B].p(t,e):(I&&(V(),et(Q[n],1,1,(()=>{Q[n]=null})),Y()),~B?(I=Q[B],I?I.p(t,e):(I=Q[B]=Z[B](t),I.c()),tt(I,1),I.m(o,null)):I=null)},i(t){U||(tt(I),U=!0)},o(t){et(I),U=!1},d(t){t&&(v(l),v(o)),v(e),W.d(t),v(n),G.d(),~B&&Q[B].d(),F=!1,s(K)}}}function Te(t,e,n){let l,s="tables",o=!1;var a;return a=async()=>{n(1,l=new me),await l.loadData(),n(1,l)},function(){if(!A)throw new Error("Function called outside component initialization");return A}().$$.on_mount.push(a),[s,l,o,async()=>{confirm("Reset tables and load default table set? Any unsaved changes will be lost.")&&(await l.reset(),n(1,l))},()=>{confirm("Delete all tables? Any unsaved changes will be lost.")&&(n(1,l.tables=[],l),n(1,l))},()=>{confirm("Delete existing tables?")&&n(1,l.tables=[],l),(t=>{let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{e.target.files[0].text().then((e=>{t(JSON.parse(e))}))},e.click()})((t=>{let e=0==l.tables.length?1:Math.max(...l.tables.map((t=>t.id)))+1,s=[];t.forEach((t=>{s.push({oldId:t.id,newId:e}),t.id=e++})),t.reduce(((t,e)=>[...t,...e.entries]),[]).forEach((t=>{t.tables=t.tables.map((t=>s.find((e=>e.oldId==t))?.newId??t))})),n(1,l.tables=[...l.tables,...t],l)}))},()=>n(2,o=!o),()=>n(0,s="tables"),()=>n(0,s="manager"),()=>(t=>{let e=URL.createObjectURL(new Blob([JSON.stringify(t)])),n=document.createElement("a");n.href=e,n.download="knave-tables.json",n.click()})(l.tables),()=>l.save(),()=>Qt("light"),()=>Qt("dark"),function(e){t.$$.not_equal(l.tables,e)&&(l.tables=e,n(1,l))},function(e){t.$$.not_equal(l.tables,e)&&(l.tables=e,n(1,l))}]}new class extends bt{constructor(t){super(),ft(this,t,Te,Ce,a,{})}}({target:document.body,props:{}})})();