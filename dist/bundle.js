(()=>{"use strict";new Set;const t="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;class e{_listeners="WeakMap"in t?new WeakMap:void 0;_observer=void 0;options;constructor(t){this.options=t}observe(t,e){return this._listeners.set(t,e),this._getObserver().observe(t,this.options),()=>{this._listeners.delete(t),this._observer.unobserve(t)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver((t=>{for(const n of t)e.entries.set(n.target,n),this._listeners.get(n.target)?.(n)})))}}e.entries="WeakMap"in t?new WeakMap:void 0;let n,l=!1;function s(t,e){t.appendChild(e)}function o(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode&&t.parentNode.removeChild(t)}function r(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function i(t){return document.createElement(t)}function c(t){return document.createTextNode(t)}function u(){return c(" ")}function d(){return c("")}function f(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t,e){e=""+e,t.data!==e&&(t.data=e)}function b(t,e){t.value=null==e?"":e}function m(t,e,n){for(let n=0;n<t.options.length;n+=1){const l=t.options[n];if(l.__value===e)return void(l.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}function p(){}function g(t){return t()}function v(){return Object.create(null)}function y(t){t.forEach(g)}function w(t){return"function"==typeof t}function _(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function k(t){n=t}new Map;const x=[],T=[];let C=[];const E=[],M=Promise.resolve();let S=!1;function L(t){C.push(t)}function O(t){E.push(t)}const N=new Set;let A=0;function R(){if(0!==A)return;const t=n;do{try{for(;A<x.length;){const t=x[A];A++,k(t),j(t.$$)}}catch(t){throw x.length=0,A=0,t}for(k(null),x.length=0,A=0;T.length;)T.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];N.has(e)||(N.add(e),e())}C.length=0}while(x.length);for(;E.length;)E.pop()();S=!1,N.clear(),k(t)}function j(t){if(null!==t.fragment){t.update(),y(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(L)}}const q=new Set;let P,D;function J(){P={r:0,c:[],p:P}}function z(){P.r||y(P.c),P=P.p}function B(t,e){t&&t.i&&(q.delete(t),t.i(e))}function H(t,e,n,l){if(t&&t.o){if(q.has(t))return;q.add(t),P.c.push((()=>{q.delete(t),l&&(n&&t.d(1),l())})),t.o(e)}else l&&l()}function U(t){return void 0!==t?.length?t:Array.from(t)}function I(t,e){H(t,1,1,(()=>{e.delete(t.key)}))}function K(t,e,n,l,s,o,a,r,i,c,u,d){let f=t.length,$=o.length,h=f;const b={};for(;h--;)b[t[h].key]=h;const m=[],p=new Map,g=new Map,v=[];for(h=$;h--;){const t=d(s,o,h),r=n(t);let i=a.get(r);i?l&&v.push((()=>i.p(t,e))):(i=c(r,t),i.c()),p.set(r,m[h]=i),r in b&&g.set(r,Math.abs(h-b[r]))}const w=new Set,_=new Set;function k(t){B(t,1),t.m(r,u),a.set(t.key,t),u=t.first,$--}for(;f&&$;){const e=m[$-1],n=t[f-1],l=e.key,s=n.key;e===n?(u=e.first,f--,$--):p.has(s)?!a.has(l)||w.has(l)?k(e):_.has(s)?f--:g.get(l)>g.get(s)?(_.add(l),k(e)):(w.add(s),f--):(i(n,a),f--)}for(;f--;){const e=t[f];p.has(e.key)||i(e,a)}for(;$;)k(m[$-1]);return y(v),m}function W(t,e,n){const l=t.$$.props[e];void 0!==l&&(t.$$.bound[l]=n,n(t.$$.ctx[l]))}function F(t){t&&t.c()}function G(t,e,n){const{fragment:l,after_update:s}=t.$$;l&&l.m(e,n),L((()=>{const e=t.$$.on_mount.map(g).filter(w);t.$$.on_destroy?t.$$.on_destroy.push(...e):y(e),t.$$.on_mount=[]})),s.forEach(L)}function Z(t,e){const n=t.$$;null!==n.fragment&&(function(t){const e=[],n=[];C.forEach((l=>-1===t.indexOf(l)?e.push(l):n.push(l))),n.forEach((t=>t())),C=e}(n.after_update),y(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Q(t,e,s,o,r,i,c=null,u=[-1]){const d=n;k(t);const f=t.$$={fragment:null,ctx:[],props:i,update:p,not_equal:r,bound:v(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:v(),dirty:u,skip_bound:!1,root:e.target||d.$$.root};c&&c(f.root);let $=!1;if(f.ctx=s?s(t,e.props||{},((e,n,...l)=>{const s=l.length?l[0]:n;return f.ctx&&r(f.ctx[e],f.ctx[e]=s)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](s),$&&function(t,e){-1===t.$$.dirty[0]&&(x.push(t),S||(S=!0,M.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n})):[],f.update(),$=!0,y(f.before_update),f.fragment=!!o&&o(f.ctx),e.target){if(e.hydrate){l=!0;const t=(h=e.target,Array.from(h.childNodes));f.fragment&&f.fragment.l(t),t.forEach(a)}else f.fragment&&f.fragment.c();e.intro&&B(t.$$.fragment),G(t,e.target,e.anchor),l=!1,R()}var h;k(d)}function X(t,e,n,l){const s=n[t]?.type;if(e="Boolean"===s&&"boolean"!=typeof e?null!=e:e,!l||!n[t])return e;if("toAttribute"===l)switch(s){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(s){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(D=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(t,e,n){super(),this.$$ctor=t,this.$$s=e,n&&this.attachShadow({mode:"open"})}addEventListener(t,e,n){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const n=this.$$c.$on(t,e);this.$$l_u.set(e,n)}super.addEventListener(t,e,n)}removeEventListener(t,e,n){if(super.removeEventListener(t,e,n),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(t){return()=>{let e;return{c:function(){e=i("slot"),"default"!==t&&$(e,"name",t)},m:function(t,n){o(t,e,n)},d:function(t){t&&a(e)}}}}const e={},n=function(t){const e={};return t.childNodes.forEach((t=>{e[t.slot||"default"]=!0})),e}(this);for(const s of this.$$s)s in n&&(e[s]=[t(s)]);for(const r of this.attributes){const c=this.$$g_p(r.name);c in this.$$d||(this.$$d[c]=X(c,r.value,this.$$p_d,"toProp"))}for(const u in this.$$p_d)u in this.$$d||void 0===this[u]||(this.$$d[u]=this[u],delete this[u]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});const l=()=>{this.$$r=!0;for(const t in this.$$p_d)if(this.$$d[t]=this.$$c.$$.ctx[this.$$c.$$.props[t]],this.$$p_d[t].reflect){const e=X(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1};this.$$c.$$.after_update.push(l),l();for(const d in this.$$l)for(const f of this.$$l[d]){const h=this.$$c.$on(d,f);this.$$l_u.set(f,h)}this.$$l={}}}attributeChangedCallback(t,e,n){this.$$r||(t=this.$$g_p(t),this.$$d[t]=X(t,n,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)}))}$$g_p(t){return Object.keys(this.$$p_d).find((e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t))||t}});class V{$$=void 0;$$set=void 0;$destroy(){Z(this,1),this.$destroy=p}$on(t,e){if(!w(e))return p;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Y(t){let e,n,l,r,u=t[0].name+"";return{c(){e=i("button"),n=c(u),$(e,"class","btn btn-light border-dark m-1")},m(a,i){o(a,e,i),s(e,n),l||(r=f(e,"click",t[2]),l=!0)},p(t,[e]){1&e&&u!==(u=t[0].name+"")&&h(n,u)},i:p,o:p,d(t){t&&a(e),l=!1,r()}}}function tt(t,e,n){let{table:l}=e,{handleRoll:s}=e;return t.$$set=t=>{"table"in t&&n(0,l=t.table),"handleRoll"in t&&n(1,s=t.handleRoll)},[l,s,()=>s(l)]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const et=class extends V{constructor(t){super(),Q(this,t,tt,Y,_,{table:0,handleRoll:1})}},nt=["0","1","2","3","4","5","6","7","8","9"],lt=new class{roll(t){let e=this.tokenize(t);return this.execute(e)}tokenize(t){let e=[],n=0;for(;n<t.length;){let s={value:t[n]};if(l=t[n],nt.indexOf(l)>=0){let l=e.length>0?e[e.length-1]:{};if("digit"==l.type){l.value+=t[n++];continue}s.type="digit"}"d"==t[n]&&(s.type="die"),"+"==t[n]&&(s.type="plus"),"-"==t[n]&&(s.type="minus"),e.push(s),n++}var l;return e}execute(t){let e=Number(t[0].value),n=Number(t[2].value),l=5==t.length&&"plus"==t[3].type?Number(t[4].value):0,s=5==t.length&&"minus"==t[3].type?Number(t[4].value):0,o=0;for(;e>0;)o+=Math.floor(Math.random()*n+1),e--;return o+l-s}};let st=({table:t,modifier:e,tables:n})=>{console.log(`Rolling ${t.roll} + ${e} on ${t.name}`);let l=lt.roll(t.roll+e),s=Math.max(...t.entries.map((t=>t.max))),o=Math.min(...t.entries.map((t=>t.min)));l>s&&(l=s),l<o&&(l=o);let a=t.entries.find((t=>t.min<=l&&t.max>=l));if(!a)return void alert(`Error - rolled ${l} on table ${t.id}`);let r=a.name;a.amount&&(r=`${r} (${lt.roll(a.amount)})`);let i=[{roll:l,table:t.name,description:r}];return a.tables?(a.tables.forEach((t=>{console.log(`finding table with id ${t}`);let l=n.find((e=>e.id==t));console.log(`found table: ${l.name}`),l?i=i.concat(st({table:l,modifier:e,tables:n})):i.push({roll:0,table:null,description:`Could not find table with id ${t}`})})),i):i};const ot={rollOnTable:st};function at(t,e,n){const l=t.slice();return l[14]=e[n],l}function rt(t,e,n){const l=t.slice();return l[17]=e[n],l}function it(t,e,n){const l=t.slice();return l[20]=e[n],l}function ct(t){let e,n,l,r=t[20]+"";return{c(){e=i("option"),n=c(r),e.__value=l=t[20],b(e,e.__value)},m(t,l){o(t,e,l),s(e,n)},p,d(t){t&&a(e)}}}function ut(t){let e,n;return e=new et({props:{table:t[17],handleRoll:t[7]}}),{c(){F(e.$$.fragment)},m(t,l){G(e,t,l),n=!0},p(t,n){const l={};16&n&&(l.table=t[17]),e.$set(l)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){H(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function dt(t){let e,n,l,r,u,d,f,$=t[14].roll+"",b=t[14].table+"",m=t[14].description+"";return{c(){var t,s;e=i("p"),n=c("Rolled "),l=c($),r=c(" on "),u=c(b),d=c(": "),f=c(m),t=e,s="white-space",null=="pre-wrap"?t.style.removeProperty(s):t.style.setProperty(s,"pre-wrap","")},m(t,a){o(t,e,a),s(e,n),s(e,l),s(e,r),s(e,u),s(e,d),s(e,f)},p(t,e){8&e&&$!==($=t[14].roll+"")&&h(l,$),8&e&&b!==(b=t[14].table+"")&&h(u,b),8&e&&m!==(m=t[14].description+"")&&h(f,m)},d(t){t&&a(e)}}}function ft(t){let e,n,l,d,p,g,v,w,_,k,x,T,C,E,M,S,O,N,A,R,j,q,P,D,I,K,W,F,G,Z,Q,X,V,Y=U(t[5]),tt=[];for(let e=0;e<Y.length;e+=1)tt[e]=ct(it(t,Y,e));let et=U(t[4]),nt=[];for(let e=0;e<et.length;e+=1)nt[e]=ut(rt(t,et,e));const lt=t=>H(nt[t],1,1,(()=>{nt[t]=null}));let st=U(t[3]),ot=[];for(let e=0;e<st.length;e+=1)ot[e]=dt(at(t,st,e));return{c(){e=i("div"),n=i("div"),l=i("div"),d=i("div"),p=i("div"),g=i("div"),v=i("div"),w=i("div"),_=i("button"),_.textContent="↓",k=u(),x=i("button"),T=c(t[2]),C=u(),E=i("button"),E.textContent="↑",M=u(),S=i("button"),S.textContent="reset",O=u(),N=i("input"),A=u(),R=i("select"),j=i("option");for(let t=0;t<tt.length;t+=1)tt[t].c();q=u(),P=i("div"),D=i("div"),I=i("div"),K=i("div");for(let t=0;t<nt.length;t+=1)nt[t].c();W=u(),F=i("div"),G=i("div"),Z=i("div");for(let t=0;t<ot.length;t+=1)ot[t].c();$(_,"class","btn btn-light border-dark"),$(x,"class","btn btn-dark border-dark"),$(E,"class","btn btn-light border-dark"),$(w,"class","btn-group m-1"),$(S,"class","btn btn-light border-dark m-1"),$(v,"class","d-flex"),$(N,"class","form-control"),$(N,"placeholder","filter"),j.__value="",b(j,j.__value),$(R,"class","form-control"),void 0===t[1]&&L((()=>t[13].call(R))),$(g,"class","card-body"),$(p,"class","card"),$(d,"class","col"),$(l,"class","row"),$(K,"class","card-body"),$(I,"class","card"),$(D,"class","col"),$(P,"class","row"),$(n,"class","col-md-6"),$(Z,"class","card-body"),$(G,"class","card"),$(F,"class","col"),$(e,"class","row")},m(a,r){o(a,e,r),s(e,n),s(n,l),s(l,d),s(d,p),s(p,g),s(g,v),s(v,w),s(w,_),s(w,k),s(w,x),s(x,T),s(w,C),s(w,E),s(v,M),s(v,S),s(g,O),s(g,N),b(N,t[0]),s(g,A),s(g,R),s(R,j);for(let t=0;t<tt.length;t+=1)tt[t]&&tt[t].m(R,null);m(R,t[1],!0),s(n,q),s(n,P),s(P,D),s(D,I),s(I,K);for(let t=0;t<nt.length;t+=1)nt[t]&&nt[t].m(K,null);s(e,W),s(e,F),s(F,G),s(G,Z);for(let t=0;t<ot.length;t+=1)ot[t]&&ot[t].m(Z,null);Q=!0,X||(V=[f(_,"click",t[9]),f(E,"click",t[10]),f(S,"click",t[11]),f(N,"input",t[12]),f(R,"change",t[13])],X=!0)},p(t,[e]){if((!Q||4&e)&&h(T,t[2]),1&e&&N.value!==t[0]&&b(N,t[0]),32&e){let n;for(Y=U(t[5]),n=0;n<Y.length;n+=1){const l=it(t,Y,n);tt[n]?tt[n].p(l,e):(tt[n]=ct(l),tt[n].c(),tt[n].m(R,null))}for(;n<tt.length;n+=1)tt[n].d(1);tt.length=Y.length}if(34&e&&m(R,t[1]),144&e){let n;for(et=U(t[4]),n=0;n<et.length;n+=1){const l=rt(t,et,n);nt[n]?(nt[n].p(l,e),B(nt[n],1)):(nt[n]=ut(l),nt[n].c(),B(nt[n],1),nt[n].m(K,null))}for(J(),n=et.length;n<nt.length;n+=1)lt(n);z()}if(8&e){let n;for(st=U(t[3]),n=0;n<st.length;n+=1){const l=at(t,st,n);ot[n]?ot[n].p(l,e):(ot[n]=dt(l),ot[n].c(),ot[n].m(Z,null))}for(;n<ot.length;n+=1)ot[n].d(1);ot.length=st.length}},i(t){if(!Q){for(let t=0;t<et.length;t+=1)B(nt[t]);Q=!0}},o(t){nt=nt.filter(Boolean);for(let t=0;t<nt.length;t+=1)H(nt[t]);Q=!1},d(t){t&&a(e),r(tt,t),r(nt,t),r(ot,t),X=!1,y(V)}}}function $t(t,e,n){let l,{tables:s=[]}=e,o="",a="+0",r="",i=[],c=[...new Set(s.filter((t=>t.category)).map((t=>t.category)))];function u(t){t+=Number(a),n(2,a=t<0?`${t}`:`+${t}`)}return c.sort(((t,e)=>t.localeCompare(e))),t.$$set=t=>{"tables"in t&&n(8,s=t.tables)},t.$$.update=()=>{259&t.$$.dirty&&n(4,l=s.filter((t=>t.category)).filter((t=>!r||t.category==r)).filter((t=>t.name.toLowerCase().includes(o.toLowerCase()))))},[o,r,a,i,l,c,u,function(t){n(3,i=ot.rollOnTable({table:t,modifier:a,tables:s}))},s,()=>u(-1),()=>u(1),()=>n(2,a="+0"),function(){o=this.value,n(0,o)},function(){r=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),n(1,r),n(5,c)}]}const ht=class extends V{constructor(t){super(),Q(this,t,$t,ft,_,{tables:8})}};function bt(t){let e,n,l,r,d,m,g;return{c(){e=i("label"),n=i("span"),l=c(t[1]),r=u(),d=i("input"),$(n,"class","collapse"),$(d,"class","form-control"),$(d,"placeholder",t[1]),$(e,"class","form-group w-100 m-0")},m(a,i){o(a,e,i),s(e,n),s(n,l),s(e,r),s(e,d),b(d,t[0]),m||(g=f(d,"input",t[2]),m=!0)},p(t,[e]){2&e&&h(l,t[1]),2&e&&$(d,"placeholder",t[1]),1&e&&d.value!==t[0]&&b(d,t[0])},i:p,o:p,d(t){t&&a(e),m=!1,g()}}}function mt(t,e,n){let{label:l}=e,{value:s}=e;return t.$$set=t=>{"label"in t&&n(1,l=t.label),"value"in t&&n(0,s=t.value)},[s,l,function(){s=this.value,n(0,s)}]}const pt=class extends V{constructor(t){super(),Q(this,t,mt,bt,_,{label:1,value:0})}};function gt(t,e,n){const l=t.slice();return l[9]=e[n],l}function vt(t,e,n){const l=t.slice();return l[12]=e[n],l}function yt(t){let e,n,l,r=t[12].name+"";return{c(){e=i("option"),n=c(r),e.__value=l=t[12].id,b(e,e.__value)},m(t,l){o(t,e,l),s(e,n)},p(t,s){4&s&&r!==(r=t[12].name+"")&&h(n,r),4&s&&l!==(l=t[12].id)&&(e.__value=l,b(e,e.__value))},d(t){t&&a(e)}}}function wt(t){let e,n,l,c,d,f,h,p=U(t[2]),g=[];for(let e=0;e<p.length;e+=1)g[e]=yt(vt(t,p,e));return{c(){e=i("div"),n=i("label"),l=i("span"),l.textContent="Roll on table",c=u(),d=i("select"),f=i("option");for(let t=0;t<g.length;t+=1)g[t].c();$(l,"class","collapse"),f.__value="0",b(f,f.__value),$(d,"class","form-control"),$(n,"class","form-group w-100 m-0")},m(a,r){o(a,e,r),s(e,n),s(n,l),s(n,c),s(n,d),s(d,f);for(let t=0;t<g.length;t+=1)g[t]&&g[t].m(d,null);m(d,t[9])},p(t,e){if(4&e){let n;for(p=U(t[2]),n=0;n<p.length;n+=1){const l=vt(t,p,n);g[n]?g[n].p(l,e):(g[n]=yt(l),g[n].c(),g[n].m(d,null))}for(;n<g.length;n+=1)g[n].d(1);g.length=p.length}5&e&&h!==(h=t[9])&&m(d,t[9])},d(t){t&&a(e),r(g,t)}}}function _t(t){let e,n,l,c,d,h,b,m,p,g,v,w,_,k,x,C,E,M,S,L,N,A,R,j,q,P,D;function J(e){t[5](e)}let z={label:"Minimum"};function I(e){t[6](e)}void 0!==t[0].min&&(z.value=t[0].min),l=new pt({props:z}),T.push((()=>W(l,"value",J)));let K={label:"Maximum"};function Q(e){t[7](e)}void 0!==t[0].max&&(K.value=t[0].max),b=new pt({props:K}),T.push((()=>W(b,"value",I)));let X={label:"Name"};void 0!==t[0].name&&(X.value=t[0].name),v=new pt({props:X}),T.push((()=>W(v,"value",Q)));let V=U(t[0].tables),Y=[];for(let e=0;e<V.length;e+=1)Y[e]=wt(gt(t,V,e));return{c(){e=i("tr"),n=i("td"),F(l.$$.fragment),d=u(),h=i("td"),F(b.$$.fragment),p=u(),g=i("td"),F(v.$$.fragment),_=u(),k=i("td"),x=i("ul");for(let t=0;t<Y.length;t+=1)Y[t].c();C=u(),E=i("div"),M=i("button"),M.textContent="Add Table",S=u(),L=i("button"),L.textContent="Remove last table",N=u(),A=i("td"),R=i("div"),j=i("button"),j.textContent="✗",$(M,"class","btn btn-light"),$(L,"class","btn btn-danger ml-1"),$(E,"class","d-flex mt-1"),$(j,"class","btn btn-danger"),$(j,"title","delete"),$(R,"class","d-flex")},m(a,r){o(a,e,r),s(e,n),G(l,n,null),s(e,d),s(e,h),G(b,h,null),s(e,p),s(e,g),G(v,g,null),s(e,_),s(e,k),s(k,x);for(let t=0;t<Y.length;t+=1)Y[t]&&Y[t].m(x,null);s(x,C),s(x,E),s(E,M),s(E,S),s(E,L),s(e,N),s(e,A),s(A,R),s(R,j),q=!0,P||(D=[f(M,"click",t[3]),f(L,"click",t[4]),f(j,"click",t[8])],P=!0)},p(t,[e]){const n={};!c&&1&e&&(c=!0,n.value=t[0].min,O((()=>c=!1))),l.$set(n);const s={};!m&&1&e&&(m=!0,s.value=t[0].max,O((()=>m=!1))),b.$set(s);const o={};if(!w&&1&e&&(w=!0,o.value=t[0].name,O((()=>w=!1))),v.$set(o),5&e){let n;for(V=U(t[0].tables),n=0;n<V.length;n+=1){const l=gt(t,V,n);Y[n]?Y[n].p(l,e):(Y[n]=wt(l),Y[n].c(),Y[n].m(x,C))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=V.length}},i(t){q||(B(l.$$.fragment,t),B(b.$$.fragment,t),B(v.$$.fragment,t),q=!0)},o(t){H(l.$$.fragment,t),H(b.$$.fragment,t),H(v.$$.fragment,t),q=!1},d(t){t&&a(e),Z(l),Z(b),Z(v),r(Y,t),P=!1,y(D)}}}function kt(t,e,n){let{entry:l}=e,{deleteEntry:s}=e,{allTables:o}=e;return t.$$set=t=>{"entry"in t&&n(0,l=t.entry),"deleteEntry"in t&&n(1,s=t.deleteEntry),"allTables"in t&&n(2,o=t.allTables)},[l,s,o,()=>{n(0,l.tables=[...l.tables,0],l)},()=>{n(0,l.tables=[...l.tables.slice(0,l.tables.length-1)],l)},function(e){t.$$.not_equal(l.min,e)&&(l.min=e,n(0,l))},function(e){t.$$.not_equal(l.max,e)&&(l.max=e,n(0,l))},function(e){t.$$.not_equal(l.name,e)&&(l.name=e,n(0,l))},()=>s(l)]}const xt=class extends V{constructor(t){super(),Q(this,t,kt,_t,_,{entry:0,deleteEntry:1,allTables:2})}};function Tt(t,e,n){const l=t.slice();return l[12]=e[n],l}function Ct(t){let e,n,l,r,c,d,h,b,m,p,g,v,w,_,k,x,C,E,M,S,L,N,A,R,j,q,P,D,Q,X,V=[],Y=new Map;function tt(e){t[9](e)}let et={label:"Display Name"};function nt(e){t[10](e)}void 0!==t[0].name&&(et.value=t[0].name),g=new pt({props:et}),T.push((()=>W(g,"value",tt)));let lt={label:"Category"};function st(e){t[11](e)}void 0!==t[0].category&&(lt.value=t[0].category),_=new pt({props:lt}),T.push((()=>W(_,"value",nt)));let ot={label:"Roll"};void 0!==t[0].roll&&(ot.value=t[0].roll),C=new pt({props:ot}),T.push((()=>W(C,"value",st)));let at=U(t[0].entries);const rt=t=>t[12].id;for(let e=0;e<at.length;e+=1){let n=Tt(t,at,e),l=rt(n);Y.set(l,V[e]=Et(l,n))}return{c(){e=i("div"),n=i("div"),l=i("button"),l.textContent="Add Entry",r=u(),c=i("button"),c.textContent="Sort Entries",d=u(),h=i("button"),h.textContent="Delete Table",b=u(),m=i("hr"),p=u(),F(g.$$.fragment),w=u(),F(_.$$.fragment),x=u(),F(C.$$.fragment),M=u(),S=i("hr"),L=u(),N=i("h2"),N.textContent="Entries",A=u(),R=i("table"),j=i("thead"),j.innerHTML='<tr><th>Minimum</th> <th>Maximum</th> <th>Text</th> <th>Tables</th> <th><span class="collapse">Actions</span></th></tr>',q=u(),P=i("tbody");for(let t=0;t<V.length;t+=1)V[t].c();$(l,"class","btn btn-light border"),$(c,"class","btn btn-light border"),$(h,"class","btn btn-danger border"),$(n,"class","d-flex"),$(R,"class","table table-striped"),$(e,"class","p-2 border")},m(a,i){o(a,e,i),s(e,n),s(n,l),s(n,r),s(n,c),s(n,d),s(n,h),s(e,b),s(e,m),s(e,p),G(g,e,null),s(e,w),G(_,e,null),s(e,x),G(C,e,null),s(e,M),s(e,S),s(e,L),s(e,N),s(e,A),s(e,R),s(R,j),s(R,q),s(R,P);for(let t=0;t<V.length;t+=1)V[t]&&V[t].m(P,null);D=!0,Q||(X=[f(l,"click",t[4]),f(c,"click",t[6]),f(h,"click",t[8])],Q=!0)},p(t,e){const n={};!v&&1&e&&(v=!0,n.value=t[0].name,O((()=>v=!1))),g.$set(n);const l={};!k&&1&e&&(k=!0,l.value=t[0].category,O((()=>k=!1))),_.$set(l);const s={};!E&&1&e&&(E=!0,s.value=t[0].roll,O((()=>E=!1))),C.$set(s),35&e&&(at=U(t[0].entries),J(),V=K(V,e,rt,1,t,at,Y,P,I,Et,null,Tt),z())},i(t){if(!D){B(g.$$.fragment,t),B(_.$$.fragment,t),B(C.$$.fragment,t);for(let t=0;t<at.length;t+=1)B(V[t]);D=!0}},o(t){H(g.$$.fragment,t),H(_.$$.fragment,t),H(C.$$.fragment,t);for(let t=0;t<V.length;t+=1)H(V[t]);D=!1},d(t){t&&a(e),Z(g),Z(_),Z(C);for(let t=0;t<V.length;t+=1)V[t].d();Q=!1,y(X)}}}function Et(t,e){let n,l,s;return l=new xt({props:{entry:e[12],deleteEntry:e[5],allTables:e[1]}}),{key:t,first:null,c(){n=d(),F(l.$$.fragment),this.first=n},m(t,e){o(t,n,e),G(l,t,e),s=!0},p(t,n){e=t;const s={};1&n&&(s.entry=e[12]),2&n&&(s.allTables=e[1]),l.$set(s)},i(t){s||(B(l.$$.fragment,t),s=!0)},o(t){H(l.$$.fragment,t),s=!1},d(t){t&&a(n),Z(l,t)}}}function Mt(t){let e,n,l,r,d,b,m,p=t[0].name+"",g=t[3]&&Ct(t);return{c(){e=i("div"),n=i("button"),l=c(p),r=u(),g&&g.c(),$(n,"class","text-left btn btn-light border w-100"),$(e,"class","w-100 mb-1")},m(a,i){o(a,e,i),s(e,n),s(n,l),s(e,r),g&&g.m(e,null),d=!0,b||(m=f(n,"click",t[7]),b=!0)},p(t,[n]){(!d||1&n)&&p!==(p=t[0].name+"")&&h(l,p),t[3]?g?(g.p(t,n),8&n&&B(g,1)):(g=Ct(t),g.c(),B(g,1),g.m(e,null)):g&&(J(),H(g,1,1,(()=>{g=null})),z())},i(t){d||(B(g),d=!0)},o(t){H(g),d=!1},d(t){t&&a(e),g&&g.d(),b=!1,m()}}}function St(t,e,n){let{table:l}=e,{allTables:s}=e,{deleteTable:o}=e,a=!1;return t.$$set=t=>{"table"in t&&n(0,l=t.table),"allTables"in t&&n(1,s=t.allTables),"deleteTable"in t&&n(2,o=t.deleteTable)},[l,s,o,a,()=>{let t=0==l.entries.length?1:Math.max(...l.entries.map((t=>t.id)))+1,e=0==l.entries.length?1:Math.max(...l.entries.map((t=>t.max)))+1;n(0,l.entries=[{id:t,name:"",min:e,max:e,tables:[]},...l.entries],l)},t=>{let e=l.entries.indexOf(t);n(0,l.entries=[...l.entries.slice(0,e),...l.entries.slice(e+1,l.entries.length)],l)},()=>{l.entries.sort(((t,e)=>t.min-e.min)),n(0,l)},()=>n(3,a=!a),()=>o(l),function(e){t.$$.not_equal(l.name,e)&&(l.name=e,n(0,l))},function(e){t.$$.not_equal(l.category,e)&&(l.category=e,n(0,l))},function(e){t.$$.not_equal(l.roll,e)&&(l.roll=e,n(0,l))}]}const Lt=class extends V{constructor(t){super(),Q(this,t,St,Mt,_,{table:0,allTables:1,deleteTable:2})}};function Ot(t,e,n){const l=t.slice();return l[8]=e[n],l}function Nt(t,e){let n,l,s;return l=new Lt({props:{table:e[8],allTables:e[0],deleteTable:e[4]}}),{key:t,first:null,c(){n=d(),F(l.$$.fragment),this.first=n},m(t,e){o(t,n,e),G(l,t,e),s=!0},p(t,n){e=t;const s={};4&n&&(s.table=e[8]),1&n&&(s.allTables=e[0]),l.$set(s)},i(t){s||(B(l.$$.fragment,t),s=!0)},o(t){H(l.$$.fragment,t),s=!1},d(t){t&&a(n),Z(l,t)}}}function At(t){let e,n,l,r,c,d,h,b,m,p,g,v,w,_,k,x=[],C=new Map;function E(e){t[7](e)}let M={label:"Filter"};void 0!==t[1]&&(M.value=t[1]),m=new pt({props:M}),T.push((()=>W(m,"value",E)));let S=U(t[2]);const L=t=>t[8].id;for(let e=0;e<S.length;e+=1){let n=Ot(t,S,e),l=L(n);C.set(l,x[e]=Nt(l,n))}return{c(){e=i("div"),n=i("button"),n.textContent="A → Z",l=u(),r=i("button"),r.textContent="Z → A",c=u(),d=i("button"),d.textContent="Add Table",h=u(),b=i("div"),F(m.$$.fragment),g=u(),v=i("div");for(let t=0;t<x.length;t+=1)x[t].c();$(n,"class","btn btn-light"),$(r,"class","btn btn-light"),$(d,"class","btn btn-light"),$(e,"class","m-2 p-2 border"),$(b,"class","m-2 p-2 border"),$(v,"class","p-2")},m(a,i){o(a,e,i),s(e,n),s(e,l),s(e,r),s(e,c),s(e,d),o(a,h,i),o(a,b,i),G(m,b,null),o(a,g,i),o(a,v,i);for(let t=0;t<x.length;t+=1)x[t]&&x[t].m(v,null);w=!0,_||(k=[f(n,"click",t[5]),f(r,"click",t[6]),f(d,"click",t[3])],_=!0)},p(t,[e]){const n={};!p&&2&e&&(p=!0,n.value=t[1],O((()=>p=!1))),m.$set(n),21&e&&(S=U(t[2]),J(),x=K(x,e,L,1,t,S,C,v,I,Nt,null,Ot),z())},i(t){if(!w){B(m.$$.fragment,t);for(let t=0;t<S.length;t+=1)B(x[t]);w=!0}},o(t){H(m.$$.fragment,t);for(let t=0;t<x.length;t+=1)H(x[t]);w=!1},d(t){t&&(a(e),a(h),a(b),a(g),a(v)),Z(m);for(let t=0;t<x.length;t+=1)x[t].d();_=!1,y(k)}}}function Rt(t,e,n){let l,{tables:s}=e,o="";return t.$$set=t=>{"tables"in t&&n(0,s=t.tables)},t.$$.update=()=>{3&t.$$.dirty&&n(2,l=s.filter((t=>!o||t.name.toLowerCase().includes(o.toLowerCase()))))},[s,o,l,()=>{let t=Math.max(...s.map((t=>t.id)))+1;n(0,s=[{id:t,name:"New Table",category:"",roll:"",entries:[]},...s])},t=>{if(!confirm(`Delete ${t.name}? This action is irreversible.`))return;let e=s.indexOf(t);n(0,s=[...s.slice(0,e),...s.slice(e+1,s.length)])},()=>{s.sort(((t,e)=>t.name.localeCompare(e.name))),n(0,s)},()=>{s.sort(((t,e)=>e.name.localeCompare(t.name))),n(0,s)},function(t){o=t,n(1,o)}]}const jt=class extends V{constructor(t){super(),Q(this,t,Rt,At,_,{tables:0})}};class qt{constructor(t={url:""}){this.url=t.url}async get(t=""){return new Promise((e=>{let n=new XMLHttpRequest;n.open("get",`${this.url}${t}`),n.onload=()=>{n.status>299?e():e(n.response)},n.send()}))}}const Pt="knave2e-gm-tools-tables";class Dt{constructor(){this.tables=[],this.client=new qt,this.done=!1}async loadData(){if(this.tables.length>0)return;let t=localStorage.getItem(Pt);if(t)try{return this.tables=JSON.parse(t),void(this.done=!0)}catch{alert("Could not parse stored tables, loading default tables.")}let e=await this.client.get("seed.json");this.tables=JSON.parse(e),this.done=!0}save(){localStorage.setItem(Pt,JSON.stringify(this.tables)),alert("Saved current tables")}}const Jt=new URLSearchParams(window.location.search).get("theme")??(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");function zt(t){window.location.search=`theme=${t}`}function Bt(t){let e;return{c(){e=i("link"),$(e,"rel","stylesheet"),$(e,"href","https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"),$(e,"integrity","sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"),$(e,"crossorigin","anonymous")},m(t,n){o(t,e,n)},d(t){t&&a(e)}}}function Ht(t){let e;return{c(){e=i("link"),$(e,"rel","stylesheet"),$(e,"href","https://cdn.jsdelivr.net/gh/vinorodrigues/bootstrap-dark@0.6.1/dist/bootstrap-dark.min.css")},m(t,n){o(t,e,n)},d(t){t&&a(e)}}}function Ut(t){let e,n,l;return{c(){e=i("a"),e.textContent="Dark mode",$(e,"class","nav-link"),$(e,"href","#")},m(s,a){o(s,e,a),n||(l=f(e,"click",t[10]),n=!0)},d(t){t&&a(e),n=!1,l()}}}function It(t){let e,n,l;return{c(){e=i("a"),e.textContent="Light mode",$(e,"class","nav-link"),$(e,"href","#")},m(s,a){o(s,e,a),n||(l=f(e,"click",t[9]),n=!0)},d(t){t&&a(e),n=!1,l()}}}function Kt(t){let e,n;return e=new jt({props:{tables:t[1].tables}}),{c(){F(e.$$.fragment)},m(t,l){G(e,t,l),n=!0},p(t,n){const l={};2&n&&(l.tables=t[1].tables),e.$set(l)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){H(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function Wt(t){let e,n,l,r,c,d,f;return d=new ht({props:{tables:t[1].tables}}),{c(){e=i("div"),n=i("div"),n.innerHTML='<div class="col"><h1>Table Roller</h1></div>',l=u(),r=i("hr"),c=u(),F(d.$$.fragment),$(n,"class","row"),$(e,"class","p-2")},m(t,a){o(t,e,a),s(e,n),s(e,l),s(e,r),s(e,c),G(d,e,null),f=!0},p(t,e){const n={};2&e&&(n.tables=t[1].tables),d.$set(n)},i(t){f||(B(d.$$.fragment,t),f=!0)},o(t){H(d.$$.fragment,t),f=!1},d(t){t&&a(e),Z(d)}}}function Ft(t){let e;return{c(){e=c("Loading table data...")},m(t,n){o(t,e,n)},p,i:p,o:p,d(t){t&&a(e)}}}function Gt(t){let e,n,l,r,c,h,b,m,p,g,v,w,_,k,x,T,C,E,M,S,L,O,N,A,R,j,q,P,D,U,I,K,W,F,G,Z,Q,X=("dark"==Jt?Ht:Bt)(t),V=("dark"==Jt?It:Ut)(t);const Y=[Ft,Wt,Kt],tt=[];function et(t,e){return t[1]?"tables"==t[0]?1:"manager"==t[0]?2:-1:0}return~(W=et(t))&&(F=tt[W]=Y[W](t)),{c(){e=i("link"),X.c(),n=d(),l=u(),r=i("main"),c=i("nav"),h=i("a"),h.textContent="Knave 2e GM Tools",b=u(),m=i("button"),m.innerHTML='<span class="navbar-toggler-icon"></span>',p=u(),g=i("div"),v=i("ul"),w=i("li"),_=i("a"),_.textContent="Table Roller",x=u(),T=i("li"),C=i("a"),C.textContent="Table Manager",M=u(),S=i("li"),L=i("a"),L.textContent="Import Tables",O=u(),N=i("li"),A=i("a"),A.textContent="Export Tables",R=u(),j=i("li"),q=i("a"),q.textContent="Save Tables",P=u(),D=i("ul"),U=i("li"),V.c(),K=u(),F&&F.c(),$(e,"rel","stylesheet"),$(e,"href","global.css"),$(h,"class","navbar-brand"),$(h,"href","#"),$(m,"class","navbar-toggler"),$(m,"type","button"),$(m,"aria-controls","navbarSupportedContent"),$(m,"aria-expanded","false"),$(m,"aria-label","Toggle navigation"),$(_,"class","nav-link"),$(_,"href","#"),$(w,"class",k="nav-item "+("tables"==t[0]?"active":"")),$(C,"class","nav-link"),$(C,"href","#"),$(T,"class",E="nav-item "+("manager"==t[0]?"active":"")),$(L,"class","nav-link"),$(L,"href","#"),$(S,"class","nav-item"),$(A,"class","nav-link"),$(A,"href","#"),$(N,"class","nav-item"),$(q,"class","nav-link"),$(q,"href","#"),$(j,"class","nav-item"),$(v,"class","navbar-nav mr-auto"),$(U,"class","nav-item"),$(D,"class","navbar-nav ml-auto"),$(g,"class",I=(t[2]?"":"collapse")+" navbar-collapse"),$(c,"class","navbar navbar-expand-lg navbar-light bg-light"),$(r,"id","app")},m(a,i){s(document.head,e),X.m(document.head,null),s(document.head,n),o(a,l,i),o(a,r,i),s(r,c),s(c,h),s(c,b),s(c,m),s(c,p),s(c,g),s(g,v),s(v,w),s(w,_),s(v,x),s(v,T),s(T,C),s(v,M),s(v,S),s(S,L),s(v,O),s(v,N),s(N,A),s(v,R),s(v,j),s(j,q),s(g,P),s(g,D),s(D,U),V.m(U,null),s(r,K),~W&&tt[W].m(r,null),G=!0,Z||(Q=[f(m,"click",t[4]),f(_,"click",t[5]),f(C,"click",t[6]),f(L,"click",t[3]),f(A,"click",t[7]),f(q,"click",t[8])],Z=!0)},p(t,[e]){(!G||1&e&&k!==(k="nav-item "+("tables"==t[0]?"active":"")))&&$(w,"class",k),(!G||1&e&&E!==(E="nav-item "+("manager"==t[0]?"active":"")))&&$(T,"class",E),(!G||4&e&&I!==(I=(t[2]?"":"collapse")+" navbar-collapse"))&&$(g,"class",I);let n=W;W=et(t),W===n?~W&&tt[W].p(t,e):(F&&(J(),H(tt[n],1,1,(()=>{tt[n]=null})),z()),~W?(F=tt[W],F?F.p(t,e):(F=tt[W]=Y[W](t),F.c()),B(F,1),F.m(r,null)):F=null)},i(t){G||(B(F),G=!0)},o(t){H(F),G=!1},d(t){t&&(a(l),a(r)),a(e),X.d(t),a(n),V.d(),~W&&tt[W].d(),Z=!1,y(Q)}}}function Zt(t,e,l){let s,o="tables",a=!1;var r;return r=async()=>{l(1,s=new Dt),await s.loadData()},function(){if(!n)throw new Error("Function called outside component initialization");return n}().$$.on_mount.push(r),[o,s,a,()=>{confirm("Delete existing tables?")&&(console.log("Deleting tables"),l(1,s.tables=[],s),console.log("Tables after deleting:"),console.log(s.tables)),(t=>{let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{e.target.files[0].text().then((e=>{t(JSON.parse(e))}))},e.click()})((t=>{let e=0==s.tables.length?1:Math.max(...s.tables.map((t=>t.id)))+1;console.log(s.tables),t.forEach((t=>{console.log(`Assigning id ${e} to ${t.name}`),t.id=e++})),l(1,s.tables=[...s.tables,...t],s)}))},()=>l(2,a=!a),()=>l(0,o="tables"),()=>l(0,o="manager"),()=>(t=>{let e=URL.createObjectURL(new Blob([JSON.stringify(t)])),n=document.createElement("a");n.href=e,n.download="knave-tables.json",n.click()})(s.tables),()=>s.save(),()=>zt("light"),()=>zt("dark")]}new class extends V{constructor(t){super(),Q(this,t,Zt,Gt,_,{})}}({target:document.body,props:{}})})();