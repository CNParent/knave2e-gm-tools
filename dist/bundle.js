(()=>{"use strict";new Set;const t="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;class e{_listeners="WeakMap"in t?new WeakMap:void 0;_observer=void 0;options;constructor(t){this.options=t}observe(t,e){return this._listeners.set(t,e),this._getObserver().observe(t,this.options),()=>{this._listeners.delete(t),this._observer.unobserve(t)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver((t=>{for(const n of t)e.entries.set(n.target,n),this._listeners.get(n.target)?.(n)})))}}e.entries="WeakMap"in t?new WeakMap:void 0;let n,l=!1;function o(t,e){t.appendChild(e)}function r(t,e,n){t.insertBefore(e,n||null)}function s(t){t.parentNode&&t.parentNode.removeChild(t)}function a(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function i(t){return document.createElement(t)}function c(t){return document.createTextNode(t)}function u(){return c(" ")}function d(){return c("")}function f(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t,e){e=""+e,t.data!==e&&(t.data=e)}function p(t,e){t.value=null==e?"":e}function m(t,e,n){for(let n=0;n<t.options.length;n+=1){const l=t.options[n];if(l.__value===e)return void(l.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}function b(){}function g(t){return t()}function v(){return Object.create(null)}function y(t){t.forEach(g)}function k(t){return"function"==typeof t}function w(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function _(t){n=t}new Map;const x=[],T=[];let M=[];const C=[],E=Promise.resolve();let L=!1;function O(t){M.push(t)}function N(t){C.push(t)}const S=new Set;let R=0;function A(){if(0!==R)return;const t=n;do{try{for(;R<x.length;){const t=x[R];R++,_(t),q(t.$$)}}catch(t){throw x.length=0,R=0,t}for(_(null),x.length=0,R=0;T.length;)T.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];S.has(e)||(S.add(e),e())}M.length=0}while(x.length);for(;C.length;)C.pop()();L=!1,S.clear(),_(t)}function q(t){if(null!==t.fragment){t.update(),y(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const P=new Set;let j,D;function z(){j={r:0,c:[],p:j}}function H(){j.r||y(j.c),j=j.p}function B(t,e){t&&t.i&&(P.delete(t),t.i(e))}function J(t,e,n,l){if(t&&t.o){if(P.has(t))return;P.add(t),j.c.push((()=>{P.delete(t),l&&(n&&t.d(1),l())})),t.o(e)}else l&&l()}function K(t){return void 0!==t?.length?t:Array.from(t)}function W(t,e){J(t,1,1,(()=>{e.delete(t.key)}))}function G(t,e,n,l,o,r,s,a,i,c,u,d){let f=t.length,$=r.length,h=f;const p={};for(;h--;)p[t[h].key]=h;const m=[],b=new Map,g=new Map,v=[];for(h=$;h--;){const t=d(o,r,h),a=n(t);let i=s.get(a);i?l&&v.push((()=>i.p(t,e))):(i=c(a,t),i.c()),b.set(a,m[h]=i),a in p&&g.set(a,Math.abs(h-p[a]))}const k=new Set,w=new Set;function _(t){B(t,1),t.m(a,u),s.set(t.key,t),u=t.first,$--}for(;f&&$;){const e=m[$-1],n=t[f-1],l=e.key,o=n.key;e===n?(u=e.first,f--,$--):b.has(o)?!s.has(l)||k.has(l)?_(e):w.has(o)?f--:g.get(l)>g.get(o)?(w.add(l),_(e)):(k.add(o),f--):(i(n,s),f--)}for(;f--;){const e=t[f];b.has(e.key)||i(e,s)}for(;$;)_(m[$-1]);return y(v),m}function U(t,e,n){const l=t.$$.props[e];void 0!==l&&(t.$$.bound[l]=n,n(t.$$.ctx[l]))}function F(t){t&&t.c()}function I(t,e,n){const{fragment:l,after_update:o}=t.$$;l&&l.m(e,n),O((()=>{const e=t.$$.on_mount.map(g).filter(k);t.$$.on_destroy?t.$$.on_destroy.push(...e):y(e),t.$$.on_mount=[]})),o.forEach(O)}function Q(t,e){const n=t.$$;null!==n.fragment&&(function(t){const e=[],n=[];M.forEach((l=>-1===t.indexOf(l)?e.push(l):n.push(l))),n.forEach((t=>t())),M=e}(n.after_update),y(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function X(t,e,o,r,a,i,c=null,u=[-1]){const d=n;_(t);const f=t.$$={fragment:null,ctx:[],props:i,update:b,not_equal:a,bound:v(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:v(),dirty:u,skip_bound:!1,root:e.target||d.$$.root};c&&c(f.root);let $=!1;if(f.ctx=o?o(t,e.props||{},((e,n,...l)=>{const o=l.length?l[0]:n;return f.ctx&&a(f.ctx[e],f.ctx[e]=o)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](o),$&&function(t,e){-1===t.$$.dirty[0]&&(x.push(t),L||(L=!0,E.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n})):[],f.update(),$=!0,y(f.before_update),f.fragment=!!r&&r(f.ctx),e.target){if(e.hydrate){l=!0;const t=(h=e.target,Array.from(h.childNodes));f.fragment&&f.fragment.l(t),t.forEach(s)}else f.fragment&&f.fragment.c();e.intro&&B(t.$$.fragment),I(t,e.target,e.anchor),l=!1,A()}var h;_(d)}function Z(t,e,n,l){const o=n[t]?.type;if(e="Boolean"===o&&"boolean"!=typeof e?null!=e:e,!l||!n[t])return e;if("toAttribute"===l)switch(o){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(o){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(D=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(t,e,n){super(),this.$$ctor=t,this.$$s=e,n&&this.attachShadow({mode:"open"})}addEventListener(t,e,n){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const n=this.$$c.$on(t,e);this.$$l_u.set(e,n)}super.addEventListener(t,e,n)}removeEventListener(t,e,n){if(super.removeEventListener(t,e,n),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(t){return()=>{let e;return{c:function(){e=i("slot"),"default"!==t&&$(e,"name",t)},m:function(t,n){r(t,e,n)},d:function(t){t&&s(e)}}}}const e={},n=function(t){const e={};return t.childNodes.forEach((t=>{e[t.slot||"default"]=!0})),e}(this);for(const o of this.$$s)o in n&&(e[o]=[t(o)]);for(const a of this.attributes){const c=this.$$g_p(a.name);c in this.$$d||(this.$$d[c]=Z(c,a.value,this.$$p_d,"toProp"))}for(const u in this.$$p_d)u in this.$$d||void 0===this[u]||(this.$$d[u]=this[u],delete this[u]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});const l=()=>{this.$$r=!0;for(const t in this.$$p_d)if(this.$$d[t]=this.$$c.$$.ctx[this.$$c.$$.props[t]],this.$$p_d[t].reflect){const e=Z(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1};this.$$c.$$.after_update.push(l),l();for(const d in this.$$l)for(const f of this.$$l[d]){const h=this.$$c.$on(d,f);this.$$l_u.set(f,h)}this.$$l={}}}attributeChangedCallback(t,e,n){this.$$r||(t=this.$$g_p(t),this.$$d[t]=Z(t,n,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)}))}$$g_p(t){return Object.keys(this.$$p_d).find((e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t))||t}});class V{$$=void 0;$$set=void 0;$destroy(){Q(this,1),this.$destroy=b}$on(t,e){if(!k(e))return b;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Y(t){let e,n,l,a,u=t[0].name+"";return{c(){e=i("button"),n=c(u),$(e,"class","btn btn-light border-dark m-1")},m(s,i){r(s,e,i),o(e,n),l||(a=f(e,"click",t[2]),l=!0)},p(t,[e]){1&e&&u!==(u=t[0].name+"")&&h(n,u)},i:b,o:b,d(t){t&&s(e),l=!1,a()}}}function tt(t,e,n){let{table:l}=e,{handleRoll:o}=e;return t.$$set=t=>{"table"in t&&n(0,l=t.table),"handleRoll"in t&&n(1,o=t.handleRoll)},[l,o,()=>o(l)]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const et=class extends V{constructor(t){super(),X(this,t,tt,Y,w,{table:0,handleRoll:1})}},nt=["0","1","2","3","4","5","6","7","8","9"],lt=new class{roll(t){let e=this.tokenize(t);return this.execute(e)}tokenize(t){let e=[],n=0;for(;n<t.length;){let o={value:t[n]};if(l=t[n],nt.indexOf(l)>=0){let l=e.length>0?e[e.length-1]:{};if("digit"==l.type){l.value+=t[n++];continue}o.type="digit"}"d"==t[n]&&(o.type="die"),"+"==t[n]&&(o.type="plus"),"-"==t[n]&&(o.type="minus"),e.push(o),n++}var l;return e}execute(t){let e=Number(t[0].value),n=Number(t[2].value),l=5==t.length&&"plus"==t[3].type?Number(t[4].value):0,o=5==t.length&&"minus"==t[3].type?Number(t[4].value):0,r=0;for(;e>0;)r+=Math.floor(Math.random()*n+1),e--;return r+l-o}};let ot=({table:t,modifier:e,tables:n})=>{console.log(`Rolling ${t.roll} + ${e} on ${t.name}`);let l=lt.roll(t.roll+e),o=Math.max(...t.entries.map((t=>t.max))),r=Math.min(...t.entries.map((t=>t.min)));l>o&&(l=o),l<r&&(l=r);let s=t.entries.find((t=>t.min<=l&&t.max>=l));if(!s)return void alert(`Error - rolled ${l} on table ${t.id}`);let a=s.name;s.amount&&(a=`${a} (${lt.roll(s.amount)})`);let i=[{roll:l,table:t.name,description:a}];return s.tables?(s.tables.forEach((t=>{console.log(`finding table with id ${t}`);let l=n.find((e=>e.id==t));console.log(`found table: ${l.name}`),l?i=i.concat(ot({table:l,modifier:e,tables:n})):i.push({roll:0,table:null,description:`Could not find table with id ${t}`})})),i):i};const rt={rollOnTable:ot};function st(t,e,n){const l=t.slice();return l[14]=e[n],l}function at(t,e,n){const l=t.slice();return l[17]=e[n],l}function it(t,e,n){const l=t.slice();return l[20]=e[n],l}function ct(t){let e,n,l,a=t[20]+"";return{c(){e=i("option"),n=c(a),e.__value=l=t[20],p(e,e.__value)},m(t,l){r(t,e,l),o(e,n)},p:b,d(t){t&&s(e)}}}function ut(t){let e,n;return e=new et({props:{table:t[17],handleRoll:t[7]}}),{c(){F(e.$$.fragment)},m(t,l){I(e,t,l),n=!0},p(t,n){const l={};16&n&&(l.table=t[17]),e.$set(l)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function dt(t){let e,n,l,a,u,d,f,$=t[14].roll+"",p=t[14].table+"",m=t[14].description+"";return{c(){var t,o;e=i("p"),n=c("Rolled "),l=c($),a=c(" on "),u=c(p),d=c(": "),f=c(m),t=e,o="white-space",null=="pre-wrap"?t.style.removeProperty(o):t.style.setProperty(o,"pre-wrap","")},m(t,s){r(t,e,s),o(e,n),o(e,l),o(e,a),o(e,u),o(e,d),o(e,f)},p(t,e){8&e&&$!==($=t[14].roll+"")&&h(l,$),8&e&&p!==(p=t[14].table+"")&&h(u,p),8&e&&m!==(m=t[14].description+"")&&h(f,m)},d(t){t&&s(e)}}}function ft(t){let e,n,l,d,b,g,v,k,w,_,x,T,M,C,E,L,N,S,R,A,q,P,j,D,W,G,U,F,I,Q,X,Z,V,Y=K(t[5]),tt=[];for(let e=0;e<Y.length;e+=1)tt[e]=ct(it(t,Y,e));let et=K(t[4]),nt=[];for(let e=0;e<et.length;e+=1)nt[e]=ut(at(t,et,e));const lt=t=>J(nt[t],1,1,(()=>{nt[t]=null}));let ot=K(t[3]),rt=[];for(let e=0;e<ot.length;e+=1)rt[e]=dt(st(t,ot,e));return{c(){e=i("div"),n=i("div"),l=i("div"),d=i("div"),b=i("div"),g=i("div"),v=i("div"),k=i("div"),w=i("button"),w.textContent="↓",_=u(),x=i("button"),T=c(t[2]),M=u(),C=i("button"),C.textContent="↑",E=u(),L=i("button"),L.textContent="reset",N=u(),S=i("input"),R=u(),A=i("select"),q=i("option");for(let t=0;t<tt.length;t+=1)tt[t].c();P=u(),j=i("div"),D=i("div"),W=i("div"),G=i("div");for(let t=0;t<nt.length;t+=1)nt[t].c();U=u(),F=i("div"),I=i("div"),Q=i("div");for(let t=0;t<rt.length;t+=1)rt[t].c();$(w,"class","btn btn-light border-dark"),$(x,"class","btn btn-dark border-dark"),$(C,"class","btn btn-light border-dark"),$(k,"class","btn-group m-1"),$(L,"class","btn btn-light border-dark m-1"),$(v,"class","d-flex"),$(S,"class","form-control"),$(S,"placeholder","filter"),q.__value="",p(q,q.__value),$(A,"class","form-control"),void 0===t[1]&&O((()=>t[13].call(A))),$(g,"class","card-body"),$(b,"class","card"),$(d,"class","col"),$(l,"class","row"),$(G,"class","card-body"),$(W,"class","card"),$(D,"class","col"),$(j,"class","row"),$(n,"class","col-md-6"),$(Q,"class","card-body"),$(I,"class","card"),$(F,"class","col"),$(e,"class","row")},m(s,a){r(s,e,a),o(e,n),o(n,l),o(l,d),o(d,b),o(b,g),o(g,v),o(v,k),o(k,w),o(k,_),o(k,x),o(x,T),o(k,M),o(k,C),o(v,E),o(v,L),o(g,N),o(g,S),p(S,t[0]),o(g,R),o(g,A),o(A,q);for(let t=0;t<tt.length;t+=1)tt[t]&&tt[t].m(A,null);m(A,t[1],!0),o(n,P),o(n,j),o(j,D),o(D,W),o(W,G);for(let t=0;t<nt.length;t+=1)nt[t]&&nt[t].m(G,null);o(e,U),o(e,F),o(F,I),o(I,Q);for(let t=0;t<rt.length;t+=1)rt[t]&&rt[t].m(Q,null);X=!0,Z||(V=[f(w,"click",t[9]),f(C,"click",t[10]),f(L,"click",t[11]),f(S,"input",t[12]),f(A,"change",t[13])],Z=!0)},p(t,[e]){if((!X||4&e)&&h(T,t[2]),1&e&&S.value!==t[0]&&p(S,t[0]),32&e){let n;for(Y=K(t[5]),n=0;n<Y.length;n+=1){const l=it(t,Y,n);tt[n]?tt[n].p(l,e):(tt[n]=ct(l),tt[n].c(),tt[n].m(A,null))}for(;n<tt.length;n+=1)tt[n].d(1);tt.length=Y.length}if(34&e&&m(A,t[1]),144&e){let n;for(et=K(t[4]),n=0;n<et.length;n+=1){const l=at(t,et,n);nt[n]?(nt[n].p(l,e),B(nt[n],1)):(nt[n]=ut(l),nt[n].c(),B(nt[n],1),nt[n].m(G,null))}for(z(),n=et.length;n<nt.length;n+=1)lt(n);H()}if(8&e){let n;for(ot=K(t[3]),n=0;n<ot.length;n+=1){const l=st(t,ot,n);rt[n]?rt[n].p(l,e):(rt[n]=dt(l),rt[n].c(),rt[n].m(Q,null))}for(;n<rt.length;n+=1)rt[n].d(1);rt.length=ot.length}},i(t){if(!X){for(let t=0;t<et.length;t+=1)B(nt[t]);X=!0}},o(t){nt=nt.filter(Boolean);for(let t=0;t<nt.length;t+=1)J(nt[t]);X=!1},d(t){t&&s(e),a(tt,t),a(nt,t),a(rt,t),Z=!1,y(V)}}}function $t(t,e,n){let l,{tables:o=[]}=e,r="",s="+0",a="",i=[],c=[...new Set(o.filter((t=>t.category)).map((t=>t.category)))];function u(t){t+=Number(s),n(2,s=t<0?`${t}`:`+${t}`)}return c.sort(((t,e)=>t.localeCompare(e))),t.$$set=t=>{"tables"in t&&n(8,o=t.tables)},t.$$.update=()=>{259&t.$$.dirty&&n(4,l=o.filter((t=>t.category)).filter((t=>!a||t.category==a)).filter((t=>t.name.toLowerCase().includes(r.toLowerCase()))))},[r,a,s,i,l,c,u,function(t){n(3,i=rt.rollOnTable({table:t,modifier:s,tables:o}))},o,()=>u(-1),()=>u(1),()=>n(2,s="+0"),function(){r=this.value,n(0,r)},function(){a=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),n(1,a),n(5,c)}]}const ht=class extends V{constructor(t){super(),X(this,t,$t,ft,w,{tables:8})}};function pt(t){let e,n,l,a,d,m,g;return{c(){e=i("label"),n=i("span"),l=c(t[1]),a=u(),d=i("input"),$(n,"class","collapse"),$(d,"class","form-control"),$(d,"placeholder",t[1]),$(e,"class","form-group w-100 m-0")},m(s,i){r(s,e,i),o(e,n),o(n,l),o(e,a),o(e,d),p(d,t[0]),m||(g=f(d,"input",t[2]),m=!0)},p(t,[e]){2&e&&h(l,t[1]),2&e&&$(d,"placeholder",t[1]),1&e&&d.value!==t[0]&&p(d,t[0])},i:b,o:b,d(t){t&&s(e),m=!1,g()}}}function mt(t,e,n){let{label:l}=e,{value:o}=e;return t.$$set=t=>{"label"in t&&n(1,l=t.label),"value"in t&&n(0,o=t.value)},[o,l,function(){o=this.value,n(0,o)}]}const bt=class extends V{constructor(t){super(),X(this,t,mt,pt,w,{label:1,value:0})}};function gt(t,e,n){const l=t.slice();return l[8]=e[n],l}function vt(t){let e,n,l=(t[2].find(a)?.name??"error: mapped table not found")+"";function a(...e){return t[6](t[8],...e)}return{c(){e=i("li"),n=c(l)},m(t,l){r(t,e,l),o(e,n)},p(e,o){t=e,5&o&&l!==(l=(t[2].find(a)?.name??"error: mapped table not found")+"")&&h(n,l)},d(t){t&&s(e)}}}function yt(t){let e,n,l,c,d,h,p,m,b,g,v,y,k,w,_,x,M,C,E,L,O,S;function R(e){t[3](e)}let A={label:"Minimum"};function q(e){t[4](e)}void 0!==t[0].min&&(A.value=t[0].min),l=new bt({props:A}),T.push((()=>U(l,"value",R)));let P={label:"Maximum"};function j(e){t[5](e)}void 0!==t[0].max&&(P.value=t[0].max),p=new bt({props:P}),T.push((()=>U(p,"value",q)));let D={label:"Name"};void 0!==t[0].name&&(D.value=t[0].name),v=new bt({props:D}),T.push((()=>U(v,"value",j)));let z=K(t[0].tables),H=[];for(let e=0;e<z.length;e+=1)H[e]=vt(gt(t,z,e));return{c(){e=i("tr"),n=i("td"),F(l.$$.fragment),d=u(),h=i("td"),F(p.$$.fragment),b=u(),g=i("td"),F(v.$$.fragment),k=u(),w=i("td"),_=i("ul");for(let t=0;t<H.length;t+=1)H[t].c();x=u(),M=i("td"),C=i("div"),E=i("button"),E.textContent="✗",$(E,"class","btn btn-danger"),$(E,"title","delete"),$(C,"class","d-flex")},m(s,a){r(s,e,a),o(e,n),I(l,n,null),o(e,d),o(e,h),I(p,h,null),o(e,b),o(e,g),I(v,g,null),o(e,k),o(e,w),o(w,_);for(let t=0;t<H.length;t+=1)H[t]&&H[t].m(_,null);o(e,x),o(e,M),o(M,C),o(C,E),L=!0,O||(S=f(E,"click",t[7]),O=!0)},p(t,[e]){const n={};!c&&1&e&&(c=!0,n.value=t[0].min,N((()=>c=!1))),l.$set(n);const o={};!m&&1&e&&(m=!0,o.value=t[0].max,N((()=>m=!1))),p.$set(o);const r={};if(!y&&1&e&&(y=!0,r.value=t[0].name,N((()=>y=!1))),v.$set(r),5&e){let n;for(z=K(t[0].tables),n=0;n<z.length;n+=1){const l=gt(t,z,n);H[n]?H[n].p(l,e):(H[n]=vt(l),H[n].c(),H[n].m(_,null))}for(;n<H.length;n+=1)H[n].d(1);H.length=z.length}},i(t){L||(B(l.$$.fragment,t),B(p.$$.fragment,t),B(v.$$.fragment,t),L=!0)},o(t){J(l.$$.fragment,t),J(p.$$.fragment,t),J(v.$$.fragment,t),L=!1},d(t){t&&s(e),Q(l),Q(p),Q(v),a(H,t),O=!1,S()}}}function kt(t,e,n){let{entry:l}=e,{deleteEntry:o}=e,{allTables:r}=e;return t.$$set=t=>{"entry"in t&&n(0,l=t.entry),"deleteEntry"in t&&n(1,o=t.deleteEntry),"allTables"in t&&n(2,r=t.allTables)},[l,o,r,function(e){t.$$.not_equal(l.min,e)&&(l.min=e,n(0,l))},function(e){t.$$.not_equal(l.max,e)&&(l.max=e,n(0,l))},function(e){t.$$.not_equal(l.name,e)&&(l.name=e,n(0,l))},(t,e)=>e.id==t,()=>o(l)]}const wt=class extends V{constructor(t){super(),X(this,t,kt,yt,w,{entry:0,deleteEntry:1,allTables:2})}};function _t(t,e,n){const l=t.slice();return l[11]=e[n],l}function xt(t){let e,n,l,a,c,d,h,p,m,b,g,v,k,w,_,x,M,C,E,L,O,S,R,A,q,P,j=[],D=new Map;function X(e){t[7](e)}let Z={label:"Display Name"};function V(e){t[8](e)}void 0!==t[0].name&&(Z.value=t[0].name),n=new bt({props:Z}),T.push((()=>U(n,"value",X)));let Y={label:"Category"};function tt(e){t[9](e)}void 0!==t[0].category&&(Y.value=t[0].category),c=new bt({props:Y}),T.push((()=>U(c,"value",V)));let et={label:"Roll"};void 0!==t[0].roll&&(et.value=t[0].roll),p=new bt({props:et}),T.push((()=>U(p,"value",tt)));let nt=K(t[0].entries);const lt=t=>t[11].id;for(let e=0;e<nt.length;e+=1){let n=_t(t,nt,e),l=lt(n);D.set(l,j[e]=Tt(l,n))}return{c(){e=i("div"),F(n.$$.fragment),a=u(),F(c.$$.fragment),h=u(),F(p.$$.fragment),b=u(),g=i("hr"),v=u(),k=i("h2"),k.textContent="Entries",w=u(),_=i("table"),x=i("thead"),x.innerHTML='<tr><th>Minimum</th> <th>Maximum</th> <th>Text</th> <th>Tables</th> <th><span class="collapse">Actions</span></th></tr>',M=u(),C=i("tbody");for(let t=0;t<j.length;t+=1)j[t].c();E=u(),L=i("div"),O=i("button"),O.textContent="Add Entry",S=u(),R=i("button"),R.textContent="Delete Table",$(_,"class","table table-striped"),$(O,"class","btn btn-light border"),$(R,"class","btn btn-danger"),$(L,"class","d-flex"),$(e,"class","p-2 border")},m(l,s){r(l,e,s),I(n,e,null),o(e,a),I(c,e,null),o(e,h),I(p,e,null),o(e,b),o(e,g),o(e,v),o(e,k),o(e,w),o(e,_),o(_,x),o(_,M),o(_,C);for(let t=0;t<j.length;t+=1)j[t]&&j[t].m(C,null);o(e,E),o(e,L),o(L,O),o(L,S),o(L,R),A=!0,q||(P=[f(O,"click",t[4]),f(R,"click",t[10])],q=!0)},p(t,e){const o={};!l&&1&e&&(l=!0,o.value=t[0].name,N((()=>l=!1))),n.$set(o);const r={};!d&&1&e&&(d=!0,r.value=t[0].category,N((()=>d=!1))),c.$set(r);const s={};!m&&1&e&&(m=!0,s.value=t[0].roll,N((()=>m=!1))),p.$set(s),35&e&&(nt=K(t[0].entries),z(),j=G(j,e,lt,1,t,nt,D,C,W,Tt,null,_t),H())},i(t){if(!A){B(n.$$.fragment,t),B(c.$$.fragment,t),B(p.$$.fragment,t);for(let t=0;t<nt.length;t+=1)B(j[t]);A=!0}},o(t){J(n.$$.fragment,t),J(c.$$.fragment,t),J(p.$$.fragment,t);for(let t=0;t<j.length;t+=1)J(j[t]);A=!1},d(t){t&&s(e),Q(n),Q(c),Q(p);for(let t=0;t<j.length;t+=1)j[t].d();q=!1,y(P)}}}function Tt(t,e){let n,l,o;return l=new wt({props:{entry:e[11],deleteEntry:e[5],allTables:e[1]}}),{key:t,first:null,c(){n=d(),F(l.$$.fragment),this.first=n},m(t,e){r(t,n,e),I(l,t,e),o=!0},p(t,n){e=t;const o={};1&n&&(o.entry=e[11]),2&n&&(o.allTables=e[1]),l.$set(o)},i(t){o||(B(l.$$.fragment,t),o=!0)},o(t){J(l.$$.fragment,t),o=!1},d(t){t&&s(n),Q(l,t)}}}function Mt(t){let e,n,l,a,d,p,m,b=t[0].name+"",g=t[3]&&xt(t);return{c(){e=i("div"),n=i("button"),l=c(b),a=u(),g&&g.c(),$(n,"class","text-left btn btn-light border w-100"),$(e,"class","w-100 m-1")},m(s,i){r(s,e,i),o(e,n),o(n,l),o(e,a),g&&g.m(e,null),d=!0,p||(m=f(n,"click",t[6]),p=!0)},p(t,[n]){(!d||1&n)&&b!==(b=t[0].name+"")&&h(l,b),t[3]?g?(g.p(t,n),8&n&&B(g,1)):(g=xt(t),g.c(),B(g,1),g.m(e,null)):g&&(z(),J(g,1,1,(()=>{g=null})),H())},i(t){d||(B(g),d=!0)},o(t){J(g),d=!1},d(t){t&&s(e),g&&g.d(),p=!1,m()}}}function Ct(t,e,n){let{table:l}=e,{allTables:o}=e,{deleteTable:r}=e,s=!1;return console.log(l),t.$$set=t=>{"table"in t&&n(0,l=t.table),"allTables"in t&&n(1,o=t.allTables),"deleteTable"in t&&n(2,r=t.deleteTable)},[l,o,r,s,()=>{let t=Math.max(...l.entries.map((t=>t.id)))+1,e=Math.max(...l.entries.map((t=>t.max)))+1;n(0,l.entries=[...l.entries,{id:t,name:"",min:e,max:e,tables:[]}],l)},t=>{let e=l.entries.indexOf(t);n(0,l.entries=[...l.entries.slice(0,e),...l.entries.slice(e+1,l.entries.length)],l)},()=>n(3,s=!s),function(e){t.$$.not_equal(l.name,e)&&(l.name=e,n(0,l))},function(e){t.$$.not_equal(l.category,e)&&(l.category=e,n(0,l))},function(e){t.$$.not_equal(l.roll,e)&&(l.roll=e,n(0,l))},()=>r(l)]}const Et=class extends V{constructor(t){super(),X(this,t,Ct,Mt,w,{table:0,allTables:1,deleteTable:2})}};function Lt(t,e,n){const l=t.slice();return l[2]=e[n],l}function Ot(t,e){let n,l,o;return l=new Et({props:{table:e[2],allTables:e[0].tables,deleteTable:e[1]}}),{key:t,first:null,c(){n=d(),F(l.$$.fragment),this.first=n},m(t,e){r(t,n,e),I(l,t,e),o=!0},p(t,n){e=t;const o={};1&n&&(o.table=e[2]),1&n&&(o.allTables=e[0].tables),l.$set(o)},i(t){o||(B(l.$$.fragment,t),o=!0)},o(t){J(l.$$.fragment,t),o=!1},d(t){t&&s(n),Q(l,t)}}}function Nt(t){let e,n,l=[],o=new Map,a=K(t[0].tables);const c=t=>t[2].id;for(let e=0;e<a.length;e+=1){let n=Lt(t,a,e),r=c(n);o.set(r,l[e]=Ot(r,n))}return{c(){e=i("div");for(let t=0;t<l.length;t+=1)l[t].c();$(e,"class","p-2")},m(t,o){r(t,e,o);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(e,null);n=!0},p(t,[n]){3&n&&(a=K(t[0].tables),z(),l=G(l,n,c,1,t,a,o,e,W,Ot,null,Lt),H())},i(t){if(!n){for(let t=0;t<a.length;t+=1)B(l[t]);n=!0}},o(t){for(let t=0;t<l.length;t+=1)J(l[t]);n=!1},d(t){t&&s(e);for(let t=0;t<l.length;t+=1)l[t].d()}}}function St(t,e,n){let{tr:l}=e;return t.$$set=t=>{"tr"in t&&n(0,l=t.tr)},[l,t=>{if(!confirm(`Delete ${t.name}? This action is irreversible.`))return;let e=l.tables.indexOf(t);n(0,l.tables=[...l.tables.slice(0,e),...l.tables.slice(e+1,l.tables.length)],l)}]}const Rt=class extends V{constructor(t){super(),X(this,t,St,Nt,w,{tr:0})}};class At{constructor(t={url:""}){this.url=t.url}async get(t=""){return new Promise((e=>{let n=new XMLHttpRequest;n.open("get",`${this.url}${t}`),n.onload=()=>{n.status>299?e():e(n.response)},n.send()}))}}class qt{constructor(){this.tables=[],this.client=new At}async loadData(){if(this.tables.length>0)return;let t=await this.client.get("seed.json");this.tables=JSON.parse(t)}}const Pt=new URLSearchParams(window.location.search).get("theme")??(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");function jt(t){window.location.search=`theme=${t}`}function Dt(t){let e;return{c(){e=i("link"),$(e,"rel","stylesheet"),$(e,"href","https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"),$(e,"integrity","sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"),$(e,"crossorigin","anonymous")},m(t,n){r(t,e,n)},d(t){t&&s(e)}}}function zt(t){let e;return{c(){e=i("link"),$(e,"rel","stylesheet"),$(e,"href","https://cdn.jsdelivr.net/gh/vinorodrigues/bootstrap-dark@0.6.1/dist/bootstrap-dark.min.css")},m(t,n){r(t,e,n)},d(t){t&&s(e)}}}function Ht(t){let e,n,l;return{c(){e=i("a"),e.textContent="Dark mode",$(e,"class","nav-link"),$(e,"href","#")},m(o,s){r(o,e,s),n||(l=f(e,"click",t[7]),n=!0)},d(t){t&&s(e),n=!1,l()}}}function Bt(t){let e,n,l;return{c(){e=i("a"),e.textContent="Light mode",$(e,"class","nav-link"),$(e,"href","#")},m(o,s){r(o,e,s),n||(l=f(e,"click",t[6]),n=!0)},d(t){t&&s(e),n=!1,l()}}}function Jt(t){let e,n;return e=new Rt({props:{tr:t[2]}}),{c(){F(e.$$.fragment)},m(t,l){I(e,t,l),n=!0},p:b,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function Kt(t){let e,l,a,c,d,f,h,p={ctx:t,current:null,token:null,hasCatch:!1,pending:Ut,then:Gt,catch:Wt,blocks:[,,,]};return function(t,e){const l=e.token={};function o(t,n,o,r){if(e.token!==l)return;e.resolved=r;let s=e.ctx;void 0!==o&&(s=s.slice(),s[o]=r);const a=t&&(e.current=t)(s);let i=!1;e.block&&(e.blocks?e.blocks.forEach(((t,l)=>{l!==n&&t&&(z(),J(t,1,1,(()=>{e.blocks[l]===t&&(e.blocks[l]=null)})),H())})):e.block.d(1),a.c(),B(a,1),a.m(e.mount(),e.anchor),i=!0),e.block=a,e.blocks&&(e.blocks[n]=a),i&&A()}if(!(r=t)||"object"!=typeof r&&"function"!=typeof r||"function"!=typeof r.then){if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}else{const l=function(){if(!n)throw new Error("Function called outside component initialization");return n}();if(t.then((t=>{_(l),o(e.then,1,e.value,t),_(null)}),(t=>{if(_(l),o(e.catch,2,e.error,t),_(null),!e.hasCatch)throw t})),e.current!==e.pending)return o(e.pending,0),!0}var r}(f=t[2].loadData(),p),{c(){e=i("div"),l=i("div"),l.innerHTML='<div class="col"><h1>Table Roller</h1></div>',a=u(),c=i("hr"),d=u(),p.block.c(),$(l,"class","row"),$(e,"class","p-2")},m(t,n){r(t,e,n),o(e,l),o(e,a),o(e,c),o(e,d),p.block.m(e,p.anchor=null),p.mount=()=>e,p.anchor=null,h=!0},p(e,n){!function(t,e,n){const l=e.slice(),{resolved:o}=t;t.current===t.then&&(l[t.value]=o),t.current===t.catch&&(l[t.error]=o),t.block.p(l,n)}(p,t=e,n)},i(t){h||(B(p.block),h=!0)},o(t){for(let t=0;t<3;t+=1)J(p.blocks[t]);h=!1},d(t){t&&s(e),p.block.d(),p.token=null,p=null}}}function Wt(t){return{c:b,m:b,p:b,i:b,o:b,d:b}}function Gt(t){let e,n;return e=new ht({props:{tables:t[2].tables}}),{c(){F(e.$$.fragment)},m(t,l){I(e,t,l),n=!0},p:b,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function Ut(t){let e;return{c(){e=c("Loading table data...")},m(t,n){r(t,e,n)},p:b,i:b,o:b,d(t){t&&s(e)}}}function Ft(t){let e,n,l,a,c,h,p,m,b,g,v,k,w,_,x,T,M,C,E,L,O,N,S,R,A,q,P,j,D=("dark"==Pt?zt:Dt)(t),K=("dark"==Pt?Bt:Ht)(t);const W=[Kt,Jt],G=[];function U(t,e){return"tables"==t[0]?0:"manager"==t[0]?1:-1}return~(R=U(t))&&(A=G[R]=W[R](t)),{c(){e=i("link"),D.c(),n=d(),l=u(),a=i("main"),c=i("nav"),h=i("a"),h.textContent="Knave 2e GM Tools",p=u(),m=i("button"),m.innerHTML='<span class="navbar-toggler-icon"></span>',b=u(),g=i("div"),v=i("ul"),k=i("li"),w=i("a"),w.textContent="Table Roller",x=u(),T=i("li"),M=i("a"),M.textContent="Table Manager",E=u(),L=i("ul"),O=i("li"),K.c(),S=u(),A&&A.c(),$(e,"rel","stylesheet"),$(e,"href","global.css"),$(h,"class","navbar-brand"),$(h,"href","#"),$(m,"class","navbar-toggler"),$(m,"type","button"),$(m,"aria-controls","navbarSupportedContent"),$(m,"aria-expanded","false"),$(m,"aria-label","Toggle navigation"),$(w,"class","nav-link"),$(w,"href","#"),$(k,"class",_="nav-item "+("tables"==t[0]?"active":"")),$(M,"class","nav-link"),$(M,"href","#"),$(T,"class",C="nav-item "+("manager"==t[0]?"active":"")),$(v,"class","navbar-nav mr-auto"),$(O,"class","nav-item"),$(L,"class","navbar-nav ml-auto"),$(g,"class",N=(t[1]?"":"collapse")+" navbar-collapse"),$(c,"class","navbar navbar-expand-lg navbar-light bg-light"),$(a,"id","app")},m(s,i){o(document.head,e),D.m(document.head,null),o(document.head,n),r(s,l,i),r(s,a,i),o(a,c),o(c,h),o(c,p),o(c,m),o(c,b),o(c,g),o(g,v),o(v,k),o(k,w),o(v,x),o(v,T),o(T,M),o(g,E),o(g,L),o(L,O),K.m(O,null),o(a,S),~R&&G[R].m(a,null),q=!0,P||(j=[f(m,"click",t[3]),f(w,"click",t[4]),f(M,"click",t[5])],P=!0)},p(t,[e]){(!q||1&e&&_!==(_="nav-item "+("tables"==t[0]?"active":"")))&&$(k,"class",_),(!q||1&e&&C!==(C="nav-item "+("manager"==t[0]?"active":"")))&&$(T,"class",C),(!q||2&e&&N!==(N=(t[1]?"":"collapse")+" navbar-collapse"))&&$(g,"class",N);let n=R;R=U(t),R===n?~R&&G[R].p(t,e):(A&&(z(),J(G[n],1,1,(()=>{G[n]=null})),H()),~R?(A=G[R],A?A.p(t,e):(A=G[R]=W[R](t),A.c()),B(A,1),A.m(a,null)):A=null)},i(t){q||(B(A),q=!0)},o(t){J(A),q=!1},d(t){t&&(s(l),s(a)),s(e),D.d(t),s(n),K.d(),~R&&G[R].d(),P=!1,y(j)}}}function It(t,e,n){let l="tables",o=new qt,r=!1;return[l,r,o,()=>n(1,r=!r),()=>n(0,l="tables"),()=>n(0,l="manager"),()=>jt("light"),()=>jt("dark")]}new class extends V{constructor(t){super(),X(this,t,It,Ft,w,{})}}({target:document.body,props:{}})})();